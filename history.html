<!DOCTYPE html>

<html class="no-js" data-content_root="./" lang="zh-CN">
<head><meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="light dark" name="color-scheme"/><meta content="width=device-width, initial-scale=1" name="viewport">
<link href="genindex.html" rel="index" title="索引"/><link href="search.html" rel="search" title="搜索"/><link href="contributing.html" rel="next" title="为 Trio 及相关项目做出贡献"/><link href="design.html" rel="prev" title="设计和内部结构"/>
<link href="_static/favicon-32.png" rel="shortcut icon"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
<title>发布历史 - Trio 0.27.0+dev 文档</title>
<link href="_static/pygments.css?v=fa44fd50" rel="stylesheet" type="text/css"/>
<link href="_static/styles/furo.css?v=354aac6f" rel="stylesheet" type="text/css"/>
<link href="_static/sphinx-codeautolink.css?v=125d5c1c" rel="stylesheet" type="text/css"/>
<link href="_static/tabs.css?v=4c969af8" rel="stylesheet" type="text/css"/>
<link href="_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="_static/hackrtd.css?v=2d9fc201" rel="stylesheet" type="text/css"/>
<link href="_static/styles/furo-extensions.css?v=302659d7" rel="stylesheet" type="text/css"/>
<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></meta></head>
<body>
<script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<symbol id="svg-toc" viewbox="0 0 24 24">
<title>Contents</title>
<svg fill="currentColor" stroke="currentColor" stroke-width="0" viewbox="0 0 1024 1024">
<path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"></path>
</svg>
</symbol>
<symbol id="svg-menu" viewbox="0 0 24 24">
<title>Menu</title>
<svg class="feather-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<line x1="3" x2="21" y1="12" y2="12"></line>
<line x1="3" x2="21" y1="6" y2="6"></line>
<line x1="3" x2="21" y1="18" y2="18"></line>
</svg>
</symbol>
<symbol id="svg-arrow-right" viewbox="0 0 24 24">
<title>Expand</title>
<svg class="feather-chevron-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<polyline points="9 18 15 12 9 6"></polyline>
</svg>
</symbol>
<symbol id="svg-sun" viewbox="0 0 24 24">
<title>Light mode</title>
<svg class="feather-sun" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="5"></circle>
<line x1="12" x2="12" y1="1" y2="3"></line>
<line x1="12" x2="12" y1="21" y2="23"></line>
<line x1="4.22" x2="5.64" y1="4.22" y2="5.64"></line>
<line x1="18.36" x2="19.78" y1="18.36" y2="19.78"></line>
<line x1="1" x2="3" y1="12" y2="12"></line>
<line x1="21" x2="23" y1="12" y2="12"></line>
<line x1="4.22" x2="5.64" y1="19.78" y2="18.36"></line>
<line x1="18.36" x2="19.78" y1="5.64" y2="4.22"></line>
</svg>
</symbol>
<symbol id="svg-moon" viewbox="0 0 24 24">
<title>Dark mode</title>
<svg class="icon-tabler-moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
</svg>
</symbol>
<symbol id="svg-sun-with-moon" viewbox="0 0 24 24">
<title>Auto light/dark, in light mode</title>
<svg class="icon-custom-derived-from-feather-sun-and-tabler-moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z" style="opacity: 50%"></path>
<line x1="14.5" x2="14.5" y1="3.25" y2="1.25"></line>
<line x1="14.5" x2="14.5" y1="15.85" y2="17.85"></line>
<line x1="10.044" x2="8.63" y1="5.094" y2="3.68"></line>
<line x1="19" x2="20.414" y1="14.05" y2="15.464"></line>
<line x1="8.2" x2="6.2" y1="9.55" y2="9.55"></line>
<line x1="20.8" x2="22.8" y1="9.55" y2="9.55"></line>
<line x1="10.044" x2="8.63" y1="14.006" y2="15.42"></line>
<line x1="19" x2="20.414" y1="5.05" y2="3.636"></line>
<circle cx="14.5" cy="9.55" r="3.6"></circle>
</svg>
</symbol>
<symbol id="svg-moon-with-sun" viewbox="0 0 24 24">
<title>Auto light/dark, in dark mode</title>
<svg class="icon-custom-derived-from-feather-sun-and-tabler-moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"></path>
<line style="opacity: 50%" x1="18" x2="18" y1="3.705" y2="2.5"></line>
<line style="opacity: 50%" x1="18" x2="18" y1="11.295" y2="12.5"></line>
<line style="opacity: 50%" x1="15.316" x2="14.464" y1="4.816" y2="3.964"></line>
<line style="opacity: 50%" x1="20.711" x2="21.563" y1="10.212" y2="11.063"></line>
<line style="opacity: 50%" x1="14.205" x2="13.001" y1="7.5" y2="7.5"></line>
<line style="opacity: 50%" x1="21.795" x2="23" y1="7.5" y2="7.5"></line>
<line style="opacity: 50%" x1="15.316" x2="14.464" y1="10.184" y2="11.036"></line>
<line style="opacity: 50%" x1="20.711" x2="21.563" y1="4.789" y2="3.937"></line>
<circle cx="18" cy="7.5" r="2.169" style="opacity: 50%"></circle>
</svg>
</symbol>
<symbol id="svg-pencil" viewbox="0 0 24 24">
<svg class="icon-tabler-pencil-code" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4"></path>
<path d="M13.5 6.5l4 4"></path>
<path d="M20 21l2 -2l-2 -2"></path>
<path d="M17 17l-2 2l2 2"></path>
</svg>
</symbol>
<symbol id="svg-eye" viewbox="0 0 24 24">
<svg class="icon-tabler-eye-code" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"></path>
<path d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008"></path>
<path d="M20 21l2 -2l-2 -2"></path>
<path d="M17 17l-2 2l2 2"></path>
</svg>
</symbol>
</svg>
<input class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<input class="sidebar-toggle" id="__toc" name="__toc" type="checkbox"/>
<label class="overlay sidebar-overlay" for="__navigation">
<div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
<div class="visually-hidden">Hide table of contents sidebar</div>
</label>
<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>
<div class="page">
<header class="mobile-header">
<div class="header-left">
<label class="nav-overlay-icon" for="__navigation">
<div class="visually-hidden">Toggle site navigation sidebar</div>
<i class="icon"><svg><use href="#svg-menu"></use></svg></i>
</label>
</div>
<div class="header-center">
<a href="index.html"><div class="brand">Trio 0.27.0+dev 文档</div></a>
</div>
<div class="header-right">
<div class="theme-toggle-container theme-toggle-header">
<button class="theme-toggle">
<div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
<svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
<svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
<svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
<svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
</button>
</div>
<label class="toc-overlay-icon toc-header-icon" for="__toc">
<div class="visually-hidden">Toggle table of contents sidebar</div>
<i class="icon"><svg><use href="#svg-toc"></use></svg></i>
</label>
</div>
</header>
<aside class="sidebar-drawer">
<div class="sidebar-container">
<div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
<div class="sidebar-logo-container">
<img alt="Logo" class="sidebar-logo" src="_static/wordmark-transparent.svg"/>
</div>
<span class="sidebar-brand-text">Trio 0.27.0+dev 文档</span>
</a><form action="search.html" class="sidebar-search-container" method="get" role="search">
<input aria-label="搜索" class="sidebar-search" name="q" placeholder="搜索"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
<p class="caption" role="heading"><span class="caption-text">Trio 友好且全面的手册：</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="awesome-trio-libraries.html">超棒的 Trio 库</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="ref-core/index.html">Trio 的核心功能</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Trio 的核心功能</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="ref-core/run.html">运行 Trio</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-core/general_principles.html">一般原则</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-core/time_clock.html">时间和时钟</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-core/cancel_timeout.html">取消和超时</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-core/tasks.html">任务</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-core/task_local_storeage.html">任务存储</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-core/task_sync.html">任务同步和通信</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-core/note_async_generator.html">异步生成器注意事项</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-core/threads.html">线程（如果必须）</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-core/debugging.html">交互式调试</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-core/exc_warn.html">异常和警告</a></li>
</ul>
</input></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="ref-io/index.html">Trio 中的 I/O</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Trio 中的 I/O</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="ref-io/abs_api.html">抽象流 API</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-io/low_level.html">使用 <code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.socket</span></code> 进行低级网络编程</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-io/async_file_io.html">异步文件系统 I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-io/subprocess.html">生成子进程</a></li>
<li class="toctree-l2"><a class="reference internal" href="ref-io/signals.html">信号</a></li>
</ul>
</input></li>
<li class="toctree-l1"><a class="reference internal" href="reference-testing.html">Trio 中的测试</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference-lowlevel.html">自省和扩展 Trio</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">设计和内部结构</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">发布历史</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">为 Trio 及相关项目做出贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="releasing.html">准备发布</a></li>
<li class="toctree-l1"><a class="reference internal" href="code-of-conduct.html">行为守则</a></li>
</ul>
</div>
</div>
</div>
</div>
</aside>
<div class="main">
<div class="content">
<div class="article-container">
<a class="back-to-top muted-link" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
</svg>
<span>Back to top</span>
</a>
<div class="content-icon-container">
<div class="view-this-page">
<a class="muted-link" href="https://github.com/hellowac/trio-zh-cn/blob/sync-docs/cn_docs/source/history.rst?plain=true" title="View this page">
<svg><use href="#svg-eye"></use></svg>
<span class="visually-hidden">View this page</span>
</a>
</div><div class="edit-this-page">
<a class="muted-link" href="https://github.com/hellowac/trio-zh-cn/edit/sync-docs/cn_docs/source/history.rst" title="Edit this page">
<svg><use href="#svg-pencil"></use></svg>
<span class="visually-hidden">Edit this page</span>
</a>
</div><div class="theme-toggle-container theme-toggle-content">
<button class="theme-toggle">
<div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
<svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
<svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
<svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
<svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
</button>
</div>
<label class="toc-overlay-icon toc-content-icon" for="__toc">
<div class="visually-hidden">Toggle table of contents sidebar</div>
<i class="icon"><svg><use href="#svg-toc"></use></svg></i>
</label>
</div>
<article id="furo-main-content" role="main">
<section id="id1">
<h1>发布历史<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h1>
<p><strong>Release history</strong></p>
<section id="trio-0-27-0-2024-10-17">
<h2>Trio 0.27.0 (2024-10-17)<a class="headerlink" href="#trio-0-27-0-2024-10-17" title="Link to this heading">¶</a></h2>
<section id="id2">
<h3>重大变更<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p><strong>Breaking changes</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"/><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p><a class="reference internal" href="ref-core/cancel_timeout.html#trio.move_on_after" title="trio.move_on_after"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.move_on_after()</span></code></a> 和 <a class="reference internal" href="ref-core/cancel_timeout.html#trio.fail_after" title="trio.fail_after"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.fail_after()</span></code></a> 之前是相对于初始化时间设置截止时间的，而不是更直观的在进入上下文管理器时设置。如果程序依赖于这种行为，这可能会导致超时发生变化。如果您想恢复之前的行为，应改为使用 <code class="docutils literal notranslate"><span class="pre">trio.move_on_at(trio.current_time()</span> <span class="pre">+</span> <span class="pre">...)</span></code>。flake8-async 现在有一条新规则来捕捉这个问题，以防您需要支持旧版本的 Trio。参见 <a class="reference external" href="https://flake8-async.readthedocs.io/en/latest/rules.html#async122" title="（在 flake8-async v24.10.2）"><span class="xref std std-ref">ASYNC122</span></a>。 (<a class="reference external" href="https://github.com/python-trio/trio/issues/2512">#2512</a>)</p></li>
</ul>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"/><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p><a class="reference internal" href="ref-core/cancel_timeout.html#trio.move_on_after" title="trio.move_on_after"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.move_on_after()</span></code></a> and <a class="reference internal" href="ref-core/cancel_timeout.html#trio.fail_after" title="trio.fail_after"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.fail_after()</span></code></a> previously set the deadline relative to initialization time, instead of more intuitively upon entering the context manager. This might change timeouts if a program relied on this behavior. If you want to restore previous behavior you should instead use <code class="docutils literal notranslate"><span class="pre">trio.move_on_at(trio.current_time()</span> <span class="pre">+</span> <span class="pre">...)</span></code>. flake8-async has a new rule to catch this, in case you're supporting older trio versions. See <a class="reference external" href="https://flake8-async.readthedocs.io/en/latest/rules.html#async122" title="（在 flake8-async v24.10.2）"><span class="xref std std-ref">ASYNC122</span></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2512">#2512</a>)</p></li>
</ul>
</div>
</div>
</section>
<section id="id3">
<h3>功能<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p><strong>Features</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"/><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>添加了 <a class="reference internal" href="ref-core/cancel_timeout.html#trio.CancelScope.relative_deadline" title="trio.CancelScope.relative_deadline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CancelScope.relative_deadline()</span></code></a> 和 <a class="reference internal" href="ref-core/cancel_timeout.html#id8" title="trio.CancelScope.is_relative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CancelScope.is_relative()</span></code></a>，以及 <code class="docutils literal notranslate"><span class="pre">__init__</span></code> 中的 <code class="docutils literal notranslate"><span class="pre">relative_deadline</span></code> 参数。这允许提前初始化作用域，但指定的相对截止时间不会在进入作用域之前倒计时。 (<a class="reference external" href="https://github.com/python-trio/trio/issues/2512">#2512</a>)</p></li>
<li><p><a class="reference internal" href="ref-core/task_sync.html#trio.Lock" title="trio.Lock"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.Lock</span></code></a> 和 <a class="reference internal" href="ref-core/task_sync.html#trio.StrictFIFOLock" title="trio.StrictFIFOLock"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.StrictFIFOLock</span></code></a> 现在会在 <a class="reference internal" href="ref-core/task_sync.html#trio.Lock.acquire" title="trio.Lock.acquire"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trio.Lock.acquire()</span></code></a> 由于锁的所有者退出而未释放锁时，抛出 <a class="reference internal" href="ref-core/exc_warn.html#trio.BrokenResourceError" title="trio.BrokenResourceError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">trio.BrokenResourceError</span></code></a>。 (<a class="reference external" href="https://github.com/python-trio/trio/issues/3035">#3035</a>)</p></li>
<li><p><a class="reference internal" href="ref-core/cancel_timeout.html#trio.move_on_at" title="trio.move_on_at"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.move_on_at()</span></code></a>、 <a class="reference internal" href="ref-core/cancel_timeout.html#trio.move_on_after" title="trio.move_on_after"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.move_on_after()</span></code></a>、 <a class="reference internal" href="ref-core/cancel_timeout.html#trio.fail_at" title="trio.fail_at"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.fail_at()</span></code></a> 和 <a class="reference internal" href="ref-core/cancel_timeout.html#trio.fail_after" title="trio.fail_after"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.fail_after()</span></code></a> 现在接受 <em>shield</em> 作为关键字参数。如果指定，它会为由上下文管理器创建的 <a class="reference internal" href="ref-core/cancel_timeout.html#trio.CancelScope" title="trio.CancelScope"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.CancelScope()</span></code></a> 对象的 <a class="reference internal" href="ref-core/cancel_timeout.html#id9" title="trio.CancelScope.shield"><code class="xref py py-func docutils literal notranslate"><span class="pre">shield()</span></code></a> 属性提供初始值。 (<a class="reference external" href="https://github.com/python-trio/trio/issues/3052">#3052</a>)</p></li>
<li><p>添加了 <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.add_parking_lot_breaker" title="trio.lowlevel.add_parking_lot_breaker"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.lowlevel.add_parking_lot_breaker()</span></code></a> 和 <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.remove_parking_lot_breaker" title="trio.lowlevel.remove_parking_lot_breaker"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.lowlevel.remove_parking_lot_breaker()</span></code></a>，以允许创建自定义的锁/信号量实现，如果任务意外退出，将打破其底层的停车场。还添加了 <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.ParkingLot.break_lot" title="trio.lowlevel.ParkingLot.break_lot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trio.lowlevel.ParkingLot.break_lot()</span></code></a>，以便有意打破停车场。 (<a class="reference external" href="https://github.com/python-trio/trio/issues/3081">#3081</a>)</p></li>
</ul>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"/><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p><a class="reference internal" href="ref-core/cancel_timeout.html#trio.CancelScope.relative_deadline" title="trio.CancelScope.relative_deadline"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CancelScope.relative_deadline()</span></code></a> and <a class="reference internal" href="ref-core/cancel_timeout.html#id8" title="trio.CancelScope.is_relative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CancelScope.is_relative()</span></code></a> added, as well as a <code class="docutils literal notranslate"><span class="pre">relative_deadline</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">__init__</span></code>. This allows initializing scopes ahead of time, but where the specified relative deadline doesn't count down until the scope is entered. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2512">#2512</a>)</p></li>
<li><p><a class="reference internal" href="ref-core/task_sync.html#trio.Lock" title="trio.Lock"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.Lock</span></code></a> and <a class="reference internal" href="ref-core/task_sync.html#trio.StrictFIFOLock" title="trio.StrictFIFOLock"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.StrictFIFOLock</span></code></a> will now raise <a class="reference internal" href="ref-core/exc_warn.html#trio.BrokenResourceError" title="trio.BrokenResourceError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">trio.BrokenResourceError</span></code></a> when <a class="reference internal" href="ref-core/task_sync.html#trio.Lock.acquire" title="trio.Lock.acquire"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trio.Lock.acquire()</span></code></a> would previously stall due to the owner of the lock exiting without releasing the lock. (<a class="reference external" href="https://github.com/python-trio/trio/issues/3035">#3035</a>)</p></li>
<li><p><a class="reference internal" href="ref-core/cancel_timeout.html#trio.move_on_at" title="trio.move_on_at"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.move_on_at()</span></code></a>, <a class="reference internal" href="ref-core/cancel_timeout.html#trio.move_on_after" title="trio.move_on_after"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.move_on_after()</span></code></a>, <a class="reference internal" href="ref-core/cancel_timeout.html#trio.fail_at" title="trio.fail_at"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.fail_at()</span></code></a> and <a class="reference internal" href="ref-core/cancel_timeout.html#trio.fail_after" title="trio.fail_after"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.fail_after()</span></code></a> now accept <em>shield</em> as a keyword argument. If specified, it provides an initial value for the <a class="reference internal" href="ref-core/cancel_timeout.html#id9" title="trio.CancelScope.shield"><code class="xref py py-func docutils literal notranslate"><span class="pre">shield()</span></code></a> attribute of the <cite>trio.CancelScope</cite> object created by the context manager. (<a class="reference external" href="https://github.com/python-trio/trio/issues/3052">#3052</a>)</p></li>
<li><p>Added <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.add_parking_lot_breaker" title="trio.lowlevel.add_parking_lot_breaker"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.lowlevel.add_parking_lot_breaker()</span></code></a> and <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.remove_parking_lot_breaker" title="trio.lowlevel.remove_parking_lot_breaker"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.lowlevel.remove_parking_lot_breaker()</span></code></a> to allow creating custom lock/semaphore implementations that will break their underlying parking lot if a task exits unexpectedly. <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.ParkingLot.break_lot" title="trio.lowlevel.ParkingLot.break_lot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trio.lowlevel.ParkingLot.break_lot()</span></code></a> is also added, to allow breaking a parking lot intentionally. (<a class="reference external" href="https://github.com/python-trio/trio/issues/3081">#3081</a>)</p></li>
</ul>
</div>
</div>
</section>
<section id="bug">
<h3>bug修复<a class="headerlink" href="#bug" title="Link to this heading">¶</a></h3>
<p><strong>Bugfixes</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"/><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>允许套接字绑定任何 <code class="docutils literal notranslate"><span class="pre">os.PathLike</span></code> 对象。 (<a class="reference external" href="https://github.com/python-trio/trio/issues/3041">#3041</a>)</p></li>
<li><p>更新 <code class="docutils literal notranslate"><span class="pre">trio.lowlevel.open_process</span></code> 的文档，允许使用字节类型。 (<a class="reference external" href="https://github.com/python-trio/trio/issues/3076">#3076</a>)</p></li>
<li><p>更新 <a class="reference internal" href="ref-core/time_clock.html#trio.sleep_forever" title="trio.sleep_forever"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.sleep_forever()</span></code></a> 为 <cite>NoReturn</cite> 类型。 (<a class="reference external" href="https://github.com/python-trio/trio/issues/3095">#3095</a>)</p></li>
</ul>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"/><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>Allow sockets to bind any <code class="docutils literal notranslate"><span class="pre">os.PathLike</span></code> object. (<a class="reference external" href="https://github.com/python-trio/trio/issues/3041">#3041</a>)</p></li>
<li><p>Update <code class="docutils literal notranslate"><span class="pre">trio.lowlevel.open_process</span></code>'s documentation to allow bytes. (<a class="reference external" href="https://github.com/python-trio/trio/issues/3076">#3076</a>)</p></li>
<li><p>Update <a class="reference internal" href="ref-core/time_clock.html#trio.sleep_forever" title="trio.sleep_forever"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.sleep_forever()</span></code></a> to be <cite>NoReturn</cite>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/3095">#3095</a>)</p></li>
</ul>
</div>
</div>
</section>
<section id="id4">
<h3>改进文档<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p><strong>Improved documentation</strong></p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"/><label class="tab-label" for="tab-set--3-input--1">中文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>为内存通道的 <code class="docutils literal notranslate"><span class="pre">statistics()</span></code> 和 <code class="docutils literal notranslate"><span class="pre">aclose</span></code> 方法添加了文档字符串。 (<a class="reference external" href="https://github.com/python-trio/trio/issues/3101">#3101</a>)</p></li>
</ul>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"/><label class="tab-label" for="tab-set--3-input--2">英文</label><div class="tab-content docutils container">
<ul class="simple">
<li><p>Add docstrings for memory channels' <code class="docutils literal notranslate"><span class="pre">statistics()</span></code> and <code class="docutils literal notranslate"><span class="pre">aclose</span></code> methods. (<a class="reference external" href="https://github.com/python-trio/trio/issues/3101">#3101</a>)</p></li>
</ul>
</div>
</div>
</section>
</section>
<section id="trio-0-26-2-2024-08-08">
<h2>Trio 0.26.2 (2024-08-08)<a class="headerlink" href="#trio-0-26-2-2024-08-08" title="Link to this heading">¶</a></h2>
<section id="bugfixes">
<h3>Bugfixes<a class="headerlink" href="#bugfixes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Remove remaining <code class="docutils literal notranslate"><span class="pre">hash</span></code> usage and fix test configuration issue that prevented it from being caught. (<a class="reference external" href="https://github.com/python-trio/trio/issues/3053">#3053</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-26-1-2024-08-05">
<h2>Trio 0.26.1 (2024-08-05)<a class="headerlink" href="#trio-0-26-1-2024-08-05" title="Link to this heading">¶</a></h2>
<section id="id5">
<h3>Bugfixes<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Switched <code class="docutils literal notranslate"><span class="pre">attrs</span></code> usage off of <code class="docutils literal notranslate"><span class="pre">hash</span></code>, which is now deprecated. (<a class="reference external" href="https://github.com/python-trio/trio/issues/3053">#3053</a>)</p></li>
</ul>
</section>
<section id="miscellaneous-internal-changes">
<h3>Miscellaneous internal changes<a class="headerlink" href="#miscellaneous-internal-changes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Use PyPI's Trusted Publishers to make releases. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2980">#2980</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-26-0-2024-07-05">
<h2>Trio 0.26.0 (2024-07-05)<a class="headerlink" href="#trio-0-26-0-2024-07-05" title="Link to this heading">¶</a></h2>
<section id="features">
<h3>Features<a class="headerlink" href="#features" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Added an interactive interpreter <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">trio</span></code>.</p>
<p>This makes it easier to try things and experiment with trio in the a Python repl.
Use the <code class="docutils literal notranslate"><span class="pre">await</span></code> keyword without needing to call <code class="docutils literal notranslate"><span class="pre">trio.run()</span></code></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>trio
<span class="go">Trio 0.21.0+dev, Python 3.10.6</span>
<span class="go">Use "await" directly instead of "trio.run()".</span>
<span class="go">Type "help", "copyright", "credits" or "license" for more information.</span>
<span class="go">&gt;&gt;&gt; import trio</span>
<span class="go">&gt;&gt;&gt; await trio.sleep(1); print("hi")  # prints after one second</span>
<span class="go">hi</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="ref-core/debugging.html#interactive-debugging"><span class="std std-ref">交互式调试</span></a> for further detail. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2972">#2972</a>)</p>
</li>
<li><p><a class="reference internal" href="reference-testing.html#trio.testing.RaisesGroup" title="trio.testing.RaisesGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.testing.RaisesGroup</span></code></a> can now catch an unwrapped exception with <code class="docutils literal notranslate"><span class="pre">unwrapped=True</span></code>. This means that the behaviour of <a class="reference external" href="https://docs.python.org/zh-cn/3/reference/compound_stmts.html#except-star" title="（在 Python v3.13）"><span class="xref std std-ref">except*</span></a> can be fully replicated in combination with <code class="docutils literal notranslate"><span class="pre">flatten_subgroups=True</span></code> (formerly <code class="docutils literal notranslate"><span class="pre">strict=False</span></code>). (<a class="reference external" href="https://github.com/python-trio/trio/issues/2989">#2989</a>)</p></li>
</ul>
</section>
<section id="id6">
<h3>Bugfixes<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fixed a bug where <a class="reference internal" href="reference-testing.html#trio.testing.RaisesGroup" title="trio.testing.RaisesGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.testing.RaisesGroup(...,</span> <span class="pre">strict=False)</span></code></a> would check the number of exceptions in the raised <cite>ExceptionGroup</cite> before flattening subgroups, leading to incorrectly failed matches.
It now properly supports end (<code class="docutils literal notranslate"><span class="pre">$</span></code>) regex markers in the <code class="docutils literal notranslate"><span class="pre">match</span></code> message, by no longer including " (x sub-exceptions)" in the string it matches against. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2989">#2989</a>)</p></li>
</ul>
</section>
<section id="deprecations-and-removals">
<h3>Deprecations and removals<a class="headerlink" href="#deprecations-and-removals" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Deprecated <code class="docutils literal notranslate"><span class="pre">strict</span></code> parameter from <a class="reference internal" href="reference-testing.html#trio.testing.RaisesGroup" title="trio.testing.RaisesGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.testing.RaisesGroup</span></code></a>, previous functionality of <code class="docutils literal notranslate"><span class="pre">strict=False</span></code> is now in <code class="docutils literal notranslate"><span class="pre">flatten_subgroups=True</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2989">#2989</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-25-1-2024-05-16">
<h2>Trio 0.25.1 (2024-05-16)<a class="headerlink" href="#trio-0-25-1-2024-05-16" title="Link to this heading">¶</a></h2>
<section id="id7">
<h3>Bugfixes<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix crash when importing trio in embedded Python on Windows, and other installs that remove docstrings. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2987">#2987</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-25-0-2024-03-17">
<h2>Trio 0.25.0 (2024-03-17)<a class="headerlink" href="#trio-0-25-0-2024-03-17" title="Link to this heading">¶</a></h2>
<section id="breaking-changes">
<h3>Breaking changes<a class="headerlink" href="#breaking-changes" title="Link to this heading">¶</a></h3>
<ul>
<li><p>The <a class="reference internal" href="ref-core/tasks.html#strict-exception-groups"><span class="std std-ref">strict_exception_groups</span></a> parameter now defaults to <cite>True</cite> in <cite>trio.run</cite> and <cite>trio.lowlevel.start_guest_run</cite>. <cite>trio.open_nursery</cite> still defaults to the same value as was specified in <cite>trio.run</cite>/<cite>trio.lowlevel.start_guest_run</cite>, but if you didn't specify it there then all subsequent calls to <cite>trio.open_nursery</cite> will change.
This is unfortunately very tricky to change with a deprecation period, as raising a <cite>DeprecationWarning</cite> whenever <a class="reference internal" href="ref-core/tasks.html#strict-exception-groups"><span class="std std-ref">strict_exception_groups</span></a> is not specified would raise a lot of unnecessary warnings.</p>
<p>Notable side effects of changing code to run with <code class="docutils literal notranslate"><span class="pre">strict_exception_groups==True</span></code></p>
<ul class="simple">
<li><p>If an iterator raises <cite>StopAsyncIteration</cite> or <cite>StopIteration</cite> inside a nursery, then python will not recognize wrapped instances of those for stopping iteration.</p></li>
<li><p><cite>trio.run_process</cite> is now documented that it can raise an <cite>ExceptionGroup</cite>. It previously could do this in very rare circumstances, but with <a class="reference internal" href="ref-core/tasks.html#strict-exception-groups"><span class="std std-ref">strict_exception_groups</span></a> set to <cite>True</cite> it will now do so whenever exceptions occur in <code class="docutils literal notranslate"><span class="pre">deliver_cancel</span></code> or with problems communicating with the subprocess.</p>
<ul>
<li><p>Errors in opening the process is now done outside the internal nursery, so if code previously ran with <code class="docutils literal notranslate"><span class="pre">strict_exception_groups=True</span></code> there are cases now where an <cite>ExceptionGroup</cite> is <em>no longer</em> added.</p></li>
</ul>
</li>
<li><p><cite>trio.TrioInternalError</cite> <code class="docutils literal notranslate"><span class="pre">.__cause__</span></code> might be wrapped in one or more <cite>ExceptionGroups &lt;ExceptionGroup&gt;</cite> (<a class="reference external" href="https://github.com/python-trio/trio/issues/2786">#2786</a>)</p></li>
</ul>
</li>
</ul>
</section>
<section id="id8">
<h3>Features<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Add <cite>trio.testing.wait_all_threads_completed</cite>, which blocks until no threads are running tasks. This is intended to be used in the same way as <cite>trio.testing.wait_all_tasks_blocked</cite>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2937">#2937</a>)</p></li>
<li><p><a class="reference internal" href="ref-io/async_file_io.html#trio.Path" title="trio.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a> is now a subclass of <a class="reference external" href="https://docs.python.org/zh-cn/3/library/pathlib.html#pathlib.PurePath" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.PurePath</span></code></a>, allowing it to interoperate with other standard
<a class="reference external" href="https://docs.python.org/zh-cn/3/library/pathlib.html#module-pathlib" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pathlib</span></code></a> types.</p>
<p>Instantiating <a class="reference internal" href="ref-io/async_file_io.html#trio.Path" title="trio.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a> now returns a concrete platform-specific subclass, one of <a class="reference internal" href="ref-io/async_file_io.html#trio.PosixPath" title="trio.PosixPath"><code class="xref py py-class docutils literal notranslate"><span class="pre">PosixPath</span></code></a> or
<a class="reference internal" href="ref-io/async_file_io.html#trio.WindowsPath" title="trio.WindowsPath"><code class="xref py py-class docutils literal notranslate"><span class="pre">WindowsPath</span></code></a>, matching the behavior of <a class="reference external" href="https://docs.python.org/zh-cn/3/library/pathlib.html#pathlib.Path" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2959">#2959</a>)</p>
</li>
</ul>
</section>
<section id="id9">
<h3>Bugfixes<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The pthread functions are now correctly found on systems using vanilla versions of musl libc. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2939">#2939</a>)</p></li>
</ul>
</section>
<section id="id10">
<h3>Miscellaneous internal changes<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>use the regular readme for the PyPI long_description (<a class="reference external" href="https://github.com/python-trio/trio/issues/2866">#2866</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-24-0-2024-01-10">
<h2>Trio 0.24.0 (2024-01-10)<a class="headerlink" href="#trio-0-24-0-2024-01-10" title="Link to this heading">¶</a></h2>
<section id="id11">
<h3>Features<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<ul>
<li><p>New helper classes: <a class="reference internal" href="reference-testing.html#trio.testing.RaisesGroup" title="trio.testing.RaisesGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">RaisesGroup</span></code></a> and <a class="reference internal" href="reference-testing.html#trio.testing.Matcher" title="trio.testing.Matcher"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matcher</span></code></a>.</p>
<p>In preparation for changing the default of <code class="docutils literal notranslate"><span class="pre">strict_exception_groups</span></code> to <cite>True</cite>, we're introducing a set of helper classes that can be used in place of <a class="reference external" href="https://docs.pytest.org/en/stable/reference/reference.html#pytest.raises">pytest.raises</a> in tests, to check for an expected <cite>ExceptionGroup</cite>.
These are provisional, and only planned to be supplied until there's a good solution in <code class="docutils literal notranslate"><span class="pre">pytest</span></code>. See <a class="reference external" href="https://github.com/pytest-dev/pytest/issues/11538">https://github.com/pytest-dev/pytest/issues/11538</a> (<a class="reference external" href="https://github.com/python-trio/trio/issues/2785">#2785</a>)</p>
</li>
</ul>
</section>
<section id="id12">
<h3>Deprecations and removals<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MultiError</span></code> has been fully removed, and all relevant trio functions now raise ExceptionGroups instead. This should not affect end users that have transitioned to using <code class="docutils literal notranslate"><span class="pre">except*</span></code> or catching ExceptionGroup/BaseExceptionGroup. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2891">#2891</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-23-2-2023-12-14">
<h2>Trio 0.23.2 (2023-12-14)<a class="headerlink" href="#trio-0-23-2-2023-12-14" title="Link to this heading">¶</a></h2>
<section id="id13">
<h3>Features<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3.12/library/typing.html#typing.TypeVarTuple">TypeVarTuple</a> is now used to fully type <a class="reference internal" href="ref-core/tasks.html#id13" title="trio.Nursery.start_soon"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nursery.start_soon()</span></code></a>, <a class="reference internal" href="ref-core/run.html#trio.run" title="trio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.run()</span></code></a>, <a class="reference internal" href="ref-core/threads.html#trio.to_thread.run_sync" title="trio.to_thread.run_sync"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.to_thread.run_sync()</span></code></a>, and other similar functions accepting <code class="docutils literal notranslate"><span class="pre">(func,</span> <span class="pre">*args)</span></code>. This means type checkers will be able to verify types are used correctly. <a class="reference internal" href="ref-core/tasks.html#id0" title="trio.Nursery.start"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nursery.start()</span></code></a> is not fully typed yet however. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2881">#2881</a>)</p></li>
</ul>
</section>
<section id="id14">
<h3>Bugfixes<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Make pyright recognize <a class="reference internal" href="ref-core/task_sync.html#trio.open_memory_channel" title="trio.open_memory_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_memory_channel()</span></code></a> as generic. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2873">#2873</a>)</p></li>
</ul>
</section>
<section id="id15">
<h3>Miscellaneous internal changes<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Moved the metadata into <span class="target" id="index-0"></span><a class="pep reference external" href="https://peps.python.org/pep-0621/"><strong>PEP 621</strong></a>-compliant <code class="file docutils literal notranslate"><span class="pre">pyproject.toml</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2860">#2860</a>)</p></li>
<li><p>do not depend on exceptiongroup pre-release (<a class="reference external" href="https://github.com/python-trio/trio/issues/2861">#2861</a>)</p></li>
<li><p>Move .coveragerc into pyproject.toml (<a class="reference external" href="https://github.com/python-trio/trio/issues/2867">#2867</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-23-1-2023-11-04">
<h2>Trio 0.23.1 (2023-11-04)<a class="headerlink" href="#trio-0-23-1-2023-11-04" title="Link to this heading">¶</a></h2>
<section id="id16">
<h3>Bugfixes<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Don't crash on import in Anaconda interpreters. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2855">#2855</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-23-0-2023-11-03">
<h2>Trio 0.23.0 (2023-11-03)<a class="headerlink" href="#trio-0-23-0-2023-11-03" title="Link to this heading">¶</a></h2>
<section id="headline-features">
<h3>Headline features<a class="headerlink" href="#headline-features" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add type hints. (<a class="reference external" href="https://github.com/python-trio/trio/issues/543">#543</a>)</p></li>
</ul>
</section>
<section id="id17">
<h3>Features<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>When exiting a nursery block, the parent task always waits for child
tasks to exit. This wait cannot be cancelled. However, previously, if
you tried to cancel it, it <em>would</em> inject a <cite>Cancelled</cite> exception,
even though it wasn't cancelled. Most users probably never noticed
either way, but injecting a <cite>Cancelled</cite> here is not really useful, and
in some rare cases caused confusion or problems, so Trio no longer
does that. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1457">#1457</a>)</p></li>
<li><p>If called from a thread spawned by <cite>trio.to_thread.run_sync</cite>, <cite>trio.from_thread.run</cite> and
<cite>trio.from_thread.run_sync</cite> now reuse the task and cancellation status of the host task;
this means that context variables and cancel scopes naturally propagate 'through'
threads spawned by Trio. You can also use <cite>trio.from_thread.check_cancelled</cite>
to efficiently check for cancellation without reentering the Trio thread. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2392">#2392</a>)</p></li>
<li><p><a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.start_guest_run" title="trio.lowlevel.start_guest_run"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.lowlevel.start_guest_run()</span></code></a> now does a bit more setup of the guest run
before it returns to its caller, so that the caller can immediately make calls to
<a class="reference internal" href="ref-core/time_clock.html#trio.current_time" title="trio.current_time"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.current_time()</span></code></a>, <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.spawn_system_task" title="trio.lowlevel.spawn_system_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.lowlevel.spawn_system_task()</span></code></a>,
<a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.current_trio_token" title="trio.lowlevel.current_trio_token"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.lowlevel.current_trio_token()</span></code></a>, etc. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2696">#2696</a>)</p></li>
</ul>
</section>
<section id="id18">
<h3>Bugfixes<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>When a starting function raises before calling <a class="reference internal" href="ref-core/tasks.html#trio.TaskStatus.started" title="trio.TaskStatus.started"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.TaskStatus.started()</span></code></a>,
<a class="reference internal" href="ref-core/tasks.html#id0" title="trio.Nursery.start"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.Nursery.start()</span></code></a> will no longer wrap the exception in an undocumented
<a class="reference external" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ExceptionGroup" title="（在 Python v3.13）"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ExceptionGroup</span></code></a>. Previously, <a class="reference internal" href="ref-core/tasks.html#id0" title="trio.Nursery.start"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.Nursery.start()</span></code></a> would incorrectly
raise an <a class="reference external" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ExceptionGroup" title="（在 Python v3.13）"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ExceptionGroup</span></code></a> containing it when using <code class="docutils literal notranslate"><span class="pre">trio.run(...,</span>
<span class="pre">strict_exception_groups=True)</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2611">#2611</a>)</p></li>
</ul>
</section>
<section id="id19">
<h3>Deprecations and removals<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>To better reflect the underlying thread handling semantics,
the keyword argument for <cite>trio.to_thread.run_sync</cite> that was
previously called <code class="docutils literal notranslate"><span class="pre">cancellable</span></code> is now named <code class="docutils literal notranslate"><span class="pre">abandon_on_cancel</span></code>.
It still does the same thing -- allow the thread to be abandoned
if the call to <cite>trio.to_thread.run_sync</cite> is cancelled -- but since we now
have other ways to propagate a cancellation without abandoning
the thread, "cancellable" has become somewhat of a misnomer.
The old <code class="docutils literal notranslate"><span class="pre">cancellable</span></code> name is now deprecated. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2841">#2841</a>)</p></li>
<li><p>Deprecated support for <code class="docutils literal notranslate"><span class="pre">math.inf</span></code> for the <code class="docutils literal notranslate"><span class="pre">backlog</span></code> argument in <code class="docutils literal notranslate"><span class="pre">open_tcp_listeners</span></code>, making its docstring correct in the fact that only <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> is raised if invalid arguments are passed. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2842">#2842</a>)</p></li>
</ul>
</section>
<section id="removals-without-deprecations">
<h3>Removals without deprecations<a class="headerlink" href="#removals-without-deprecations" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Drop support for Python3.7 and PyPy3.7/3.8. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2668">#2668</a>)</p></li>
<li><p>Removed special <code class="docutils literal notranslate"><span class="pre">MultiError</span></code> traceback handling for IPython. As of <a class="reference external" href="https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-15">version 8.15</a> <cite>ExceptionGroup</cite> is handled natively. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2702">#2702</a>)</p></li>
</ul>
</section>
<section id="id20">
<h3>Miscellaneous internal changes<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Trio now indicates its presence to <cite>sniffio</cite> using the <code class="docutils literal notranslate"><span class="pre">sniffio.thread_local</span></code>
interface that is preferred since sniffio v1.3.0. This should be less likely
than the previous approach to cause <a class="reference external" href="https://sniffio.readthedocs.io/en/latest/index.html#sniffio.current_async_library" title="（在 sniffio v1.3.1+dev）"><code class="xref py py-func docutils literal notranslate"><span class="pre">sniffio.current_async_library()</span></code></a> to
return incorrect results due to unintended inheritance of contextvars. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2700">#2700</a>)</p></li>
<li><p>On windows, if SIO_BASE_HANDLE failed and SIO_BSP_HANDLE_POLL didn't return a different socket, runtime error will now raise from the OSError that indicated the issue so that in the event it does happen it might help with debugging. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2807">#2807</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-22-2-2023-07-13">
<h2>Trio 0.22.2 (2023-07-13)<a class="headerlink" href="#trio-0-22-2-2023-07-13" title="Link to this heading">¶</a></h2>
<section id="id21">
<h3>Bugfixes<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">PermissionError</span></code> when importing <cite>trio</cite> due to trying to access <code class="docutils literal notranslate"><span class="pre">pthread</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2688">#2688</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-22-1-2023-07-02">
<h2>Trio 0.22.1 (2023-07-02)<a class="headerlink" href="#trio-0-22-1-2023-07-02" title="Link to this heading">¶</a></h2>
<section id="id22">
<h3>Breaking changes<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Timeout functions now raise <cite>ValueError</cite> if passed <cite>math.nan</cite>. This includes <cite>trio.sleep</cite>, <cite>trio.sleep_until</cite>, <cite>trio.move_on_at</cite>, <cite>trio.move_on_after</cite>, <cite>trio.fail_at</cite> and <cite>trio.fail_after</cite>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2493">#2493</a>)</p></li>
</ul>
</section>
<section id="id23">
<h3>Features<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Added support for naming threads created with <cite>trio.to_thread.run_sync</cite>, requires pthreads so is only available on POSIX platforms with glibc installed. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1148">#1148</a>)</p></li>
<li><p><cite>trio.socket.socket</cite> now prints the address it tried to connect to upon failure. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1810">#1810</a>)</p></li>
</ul>
</section>
<section id="id24">
<h3>Bugfixes<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fixed a crash that can occur when running Trio within an embedded Python interpreter, by handling the <cite>TypeError</cite> that is raised when trying to (re-)install a C signal handler. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2333">#2333</a>)</p></li>
<li><p>Fix <a class="reference external" href="https://sniffio.readthedocs.io/en/latest/index.html#sniffio.current_async_library" title="（在 sniffio v1.3.1+dev）"><code class="xref py py-func docutils literal notranslate"><span class="pre">sniffio.current_async_library()</span></code></a> when Trio tasks are spawned from a non-Trio context (such as when using trio-asyncio). Previously, a regular Trio task would inherit the non-Trio library name, and spawning a system task would cause the non-Trio caller to start thinking it was Trio. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2462">#2462</a>)</p></li>
<li><p>Issued a new release as in the git tag for 0.22.0, <code class="docutils literal notranslate"><span class="pre">trio.__version__</span></code> is incorrectly set to 0.21.0+dev. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2485">#2485</a>)</p></li>
</ul>
</section>
<section id="improved-documentation">
<h3>Improved documentation<a class="headerlink" href="#improved-documentation" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Documented that <a class="reference internal" href="ref-core/tasks.html#id13" title="trio.Nursery.start_soon"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Nursery.start_soon</span></code></a> does not guarantee task ordering. (<a class="reference external" href="https://github.com/python-trio/trio/issues/970">#970</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-22-0-2022-09-28">
<h2>Trio 0.22.0 (2022-09-28)<a class="headerlink" href="#trio-0-22-0-2022-09-28" title="Link to this heading">¶</a></h2>
<section id="id25">
<h3>Headline features<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">MultiError</span></code> has been deprecated in favor of the standard <a class="reference external" href="https://docs.python.org/zh-cn/3/library/exceptions.html#BaseExceptionGroup" title="（在 Python v3.13）"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BaseExceptionGroup</span></code></a>
(introduced in <span class="target" id="index-1"></span><a class="pep reference external" href="https://peps.python.org/pep-0654/"><strong>PEP 654</strong></a>). On Python versions below 3.11, this exception and its
derivative <a class="reference external" href="https://docs.python.org/zh-cn/3/library/exceptions.html#ExceptionGroup" title="（在 Python v3.13）"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ExceptionGroup</span></code></a> are provided by the <a class="reference external" href="https://pypi.org/project/exceptiongroup/">backport</a>. Trio still raises
<code class="docutils literal notranslate"><span class="pre">MultiError</span></code>, but it has been refactored into a subclass of <a class="reference external" href="https://docs.python.org/zh-cn/3/library/exceptions.html#BaseExceptionGroup" title="（在 Python v3.13）"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BaseExceptionGroup</span></code></a>
which users should catch instead of <code class="docutils literal notranslate"><span class="pre">MultiError</span></code>. Uses of the <code class="docutils literal notranslate"><span class="pre">MultiError.filter()</span></code>
class method should be replaced with <a class="reference external" href="https://docs.python.org/zh-cn/3/library/exceptions.html#BaseExceptionGroup.split" title="（在 Python v3.13）"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BaseExceptionGroup.split()</span></code></a>. Uses of the
<code class="docutils literal notranslate"><span class="pre">MultiError.catch()</span></code> class method should be replaced with either <code class="docutils literal notranslate"><span class="pre">except*</span></code> clauses
(on Python 3.11+) or the <code class="docutils literal notranslate"><span class="pre">exceptiongroup.catch()</span></code> context manager provided by the
<a class="reference external" href="https://pypi.org/project/exceptiongroup/">backport</a>.</p>
<p>See the <a class="reference internal" href="ref-core/tasks.html#exceptiongroups"><span class="std std-ref">updated documentation</span></a> for details.
(<a class="reference external" href="https://github.com/python-trio/trio/issues/2211">#2211</a>)</p>
</li>
</ul>
</section>
<section id="id26">
<h3>Features<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Added support for <a class="reference external" href="https://en.wikipedia.org/wiki/Datagram_Transport_Layer_Security">Datagram TLS</a>,
for secure communication over UDP. Currently requires <a class="reference external" href="https://pypi.org/p/pyopenssl">PyOpenSSL</a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2010">#2010</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-21-0-2022-06-07">
<h2>Trio 0.21.0 (2022-06-07)<a class="headerlink" href="#trio-0-21-0-2022-06-07" title="Link to this heading">¶</a></h2>
<section id="id27">
<h3>Features<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Trio now supports Python 3.11. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2270">#2270</a>, <a class="reference external" href="https://github.com/python-trio/trio/issues/2318">#2318</a>, <a class="reference external" href="https://github.com/python-trio/trio/issues/2319">#2319</a>)</p></li>
</ul>
</section>
<section id="id28">
<h3>Deprecations and Removals<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Remove support for Python 3.6. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2210">#2210</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-20-0-2022-02-21">
<h2>Trio 0.20.0 (2022-02-21)<a class="headerlink" href="#trio-0-20-0-2022-02-21" title="Link to this heading">¶</a></h2>
<section id="id29">
<h3>Features<a class="headerlink" href="#id29" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>You can now conveniently spawn a child process in a background task
and interact it with on the fly using <code class="docutils literal notranslate"><span class="pre">process</span> <span class="pre">=</span> <span class="pre">await</span>
<span class="pre">nursery.start(run_process,</span> <span class="pre">...)</span></code>. See <cite>run_process</cite> for more details.
We recommend most users switch to this new API. Also note that:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.open_process</span></code> has been deprecated in favor of
<cite>trio.lowlevel.open_process</cite>,</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">aclose</span></code> method on <cite>Process</cite> has been deprecated along with
<code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">with</span> <span class="pre">process_obj</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1104">#1104</a>)</p></li>
</ul>
</li>
<li><p>Now context variables set with <cite>contextvars</cite> are preserved when running functions
in a worker thread with <cite>trio.to_thread.run_sync</cite>, or when running
functions from the worker thread in the parent Trio thread with
<cite>trio.from_thread.run</cite>, and <cite>trio.from_thread.run_sync</cite>.
This is done by automatically copying the <cite>contextvars</cite> context.
<cite>trio.lowlevel.spawn_system_task</cite> now also receives an optional <code class="docutils literal notranslate"><span class="pre">context</span></code> argument. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2160">#2160</a>)</p></li>
</ul>
</section>
<section id="id30">
<h3>Bugfixes<a class="headerlink" href="#id30" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Trio now avoids creating cyclic garbage when a <code class="docutils literal notranslate"><span class="pre">MultiError</span></code> is generated and
filtered, including invisibly within the cancellation system. This means errors raised
through nurseries and cancel scopes should result in less GC latency. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2063">#2063</a>)</p></li>
<li><p>Trio now deterministically cleans up file descriptors that were opened before
subprocess creation fails. Previously, they would remain open until the next run of
the garbage collector. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2193">#2193</a>)</p></li>
<li><p>Add compatibility with OpenSSL 3.0 on newer Python and PyPy versions by working
around <code class="docutils literal notranslate"><span class="pre">SSLEOFError</span></code> not being raised properly. (<a class="reference external" href="https://github.com/python-trio/trio/issues/2203">#2203</a>)</p></li>
<li><p>Fix a bug that could cause <cite>Process.wait</cite> to hang on Linux systems using pidfds, if
another task were to access <cite>Process.returncode</cite> after the process exited but before
<code class="docutils literal notranslate"><span class="pre">wait</span></code> woke up (<a class="reference external" href="https://github.com/python-trio/trio/issues/2209">#2209</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-19-0-2021-06-15">
<h2>Trio 0.19.0 (2021-06-15)<a class="headerlink" href="#trio-0-19-0-2021-06-15" title="Link to this heading">¶</a></h2>
<section id="id31">
<h3>Features<a class="headerlink" href="#id31" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Trio now supports Python 3.10. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1921">#1921</a>)</p></li>
<li><p>Use slots for <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.Task" title="trio.lowlevel.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">Task</span></code></a> which should make them slightly smaller and faster. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1927">#1927</a>)</p></li>
<li><p>Make <a class="reference internal" href="ref-core/task_sync.html#trio.Event" title="trio.Event"><code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code></a> more lightweight by using less objects (about 2 rather
than 5, including a nested ParkingLot and attribute dicts) and simpler
structures (set rather than OrderedDict).  This may benefit applications that
create a large number of event instances, such as with the "replace event
object on every set()" idiom. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1948">#1948</a>)</p></li>
</ul>
</section>
<section id="id32">
<h3>Bugfixes<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The event loop now holds on to references of coroutine frames for only
the minimum necessary period of time. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1864">#1864</a>)</p></li>
<li><p>The <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.TrioToken" title="trio.lowlevel.TrioToken"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrioToken</span></code></a> class can now be used as a target of a weak reference. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1924">#1924</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-18-0-2021-01-11">
<h2>Trio 0.18.0 (2021-01-11)<a class="headerlink" href="#trio-0-18-0-2021-01-11" title="Link to this heading">¶</a></h2>
<section id="id33">
<h3>Features<a class="headerlink" href="#id33" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add synchronous <code class="docutils literal notranslate"><span class="pre">.close()</span></code> methods and context manager (<code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">x</span></code>) support
for <cite>.MemorySendChannel</cite> and <cite>.MemoryReceiveChannel</cite>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1797">#1797</a>)</p></li>
</ul>
</section>
<section id="id34">
<h3>Bugfixes<a class="headerlink" href="#id34" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Previously, on Windows, Trio programs using thousands of sockets at the same time could trigger extreme slowdowns in the Windows kernel. Now, Trio works around this issue, so you should be able to use as many sockets as you want. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1280">#1280</a>)</p></li>
<li><p><a class="reference internal" href="ref-core/threads.html#trio.from_thread.run" title="trio.from_thread.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.from_thread.run()</span></code></a> no longer crashes the Trio run if it is
executed after the system nursery has been closed but before the run
has finished. Calls made at this time will now raise
<cite>trio.RunFinishedError</cite>.  This fixes a regression introduced in
Trio 0.17.0.  The window in question is only one scheduler tick long in
most cases, but may be longer if async generators need to be cleaned up. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1738">#1738</a>)</p></li>
<li><p>Fix a crash in pypy-3.7 (<a class="reference external" href="https://github.com/python-trio/trio/issues/1765">#1765</a>)</p></li>
<li><p>Trio now avoids creating cyclic garbage as often. This should have a
minimal impact on most programs, but can slightly reduce how often the
cycle collector GC runs on CPython, which can reduce latency spikes. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1770">#1770</a>)</p></li>
</ul>
</section>
<section id="id35">
<h3>Deprecations and removals<a class="headerlink" href="#id35" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Remove deprecated <code class="docutils literal notranslate"><span class="pre">max_refill_bytes</span></code> from <a class="reference internal" href="ref-io/abs_api.html#trio.SSLStream" title="trio.SSLStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSLStream</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/959">#959</a>)</p></li>
<li><p>Remove the deprecated <code class="docutils literal notranslate"><span class="pre">tiebreaker</span></code> argument to <cite>trio.testing.wait_all_tasks_blocked</cite>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1558">#1558</a>)</p></li>
<li><p>Remove the deprecated <code class="docutils literal notranslate"><span class="pre">trio.hazmat</span></code> module. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1722">#1722</a>)</p></li>
<li><p>Stop allowing subclassing public classes. This behavior was deprecated in 0.15.0. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1726">#1726</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-17-0-2020-09-15">
<h2>Trio 0.17.0 (2020-09-15)<a class="headerlink" href="#trio-0-17-0-2020-09-15" title="Link to this heading">¶</a></h2>
<section id="id36">
<h3>Headline features<a class="headerlink" href="#id36" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Trio now supports automatic <a class="reference internal" href="ref-core/note_async_generator.html#async-generators"><span class="std std-ref">async generator finalization</span></a>, so more async generators will work even if you
don't wrap them in <code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">with</span> <span class="pre">async_generator.aclosing():</span></code>
blocks. Please see the documentation for important caveats; in
particular, yielding within a nursery or cancel scope remains
unsupported. (<a class="reference external" href="https://github.com/python-trio/trio/issues/265">#265</a>)</p></li>
</ul>
</section>
<section id="id37">
<h3>Features<a class="headerlink" href="#id37" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><cite>trio.open_tcp_stream</cite> has a new <code class="docutils literal notranslate"><span class="pre">local_address=</span></code> keyword argument
that can be used on machines with multiple IP addresses to control
which IP is used for the outgoing connection. (<a class="reference external" href="https://github.com/python-trio/trio/issues/275">#275</a>)</p></li>
<li><p>If you pass a raw IP address into <code class="docutils literal notranslate"><span class="pre">sendto</span></code>, it no longer spends any
time trying to resolve the hostname. If you're using UDP, this should
substantially reduce your per-packet overhead. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1595">#1595</a>)</p></li>
<li><p><cite>trio.lowlevel.checkpoint</cite> is now much faster. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1613">#1613</a>)</p></li>
<li><p>We switched to a new, lower-overhead data structure to track upcoming
timeouts, which should make your programs faster. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1629">#1629</a>)</p></li>
</ul>
</section>
<section id="id38">
<h3>Bugfixes<a class="headerlink" href="#id38" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>On macOS and BSDs, explicitly close our wakeup socketpair when we're
done with it. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1621">#1621</a>)</p></li>
<li><p>Trio can now be imported when <cite>sys.excepthook</cite> is a <cite>functools.partial</cite> instance, which might occur in a
<code class="docutils literal notranslate"><span class="pre">pytest-qt</span></code> test function. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1630">#1630</a>)</p></li>
<li><p>The thread cache didn't release its reference to the previous job. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1638">#1638</a>)</p></li>
<li><p>On Windows, Trio now works around the buggy behavior of certain
Layered Service Providers (system components that can intercept
network activity) that are built on top of a commercially available
library called Komodia Redirector. This benefits users of products
such as Astrill VPN and Qustodio parental controls. Previously, Trio
would crash on startup when run on a system where such a product was
installed. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1659">#1659</a>)</p></li>
</ul>
</section>
<section id="id39">
<h3>Deprecations and removals<a class="headerlink" href="#id39" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">wait_socket_*</span></code>, <code class="docutils literal notranslate"><span class="pre">notify_socket_closing</span></code>, <code class="docutils literal notranslate"><span class="pre">notify_fd_closing</span></code>, <code class="docutils literal notranslate"><span class="pre">run_sync_in_worker_thread</span></code> and <code class="docutils literal notranslate"><span class="pre">current_default_worker_thread_limiter</span></code>. They were deprecated in 0.12.0. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1596">#1596</a>)</p></li>
</ul>
</section>
<section id="id40">
<h3>Miscellaneous internal changes<a class="headerlink" href="#id40" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>When using <a class="reference internal" href="reference-lowlevel.html#instrumentation"><span class="std std-ref">instruments</span></a>, you now only "pay for what you use":
if there are no instruments installed that override a particular hook such as
<a class="reference internal" href="reference-lowlevel.html#trio.abc.Instrument.before_task_step" title="trio.abc.Instrument.before_task_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_task_step()</span></code></a>, then Trio doesn't waste any effort
on checking its instruments when the event corresponding to that hook occurs.
Previously, installing any instrument would incur all the instrumentation overhead,
even for hooks no one was interested in. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1340">#1340</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-16-0-2020-06-10">
<h2>Trio 0.16.0 (2020-06-10)<a class="headerlink" href="#trio-0-16-0-2020-06-10" title="Link to this heading">¶</a></h2>
<section id="id41">
<h3>Headline features<a class="headerlink" href="#id41" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>If you want to use Trio, but are stuck with some other event loop like
Qt or PyGame, then good news: now you can have both. For details, see:
<a class="reference internal" href="reference-lowlevel.html#guest-mode"><span class="std std-ref">使用“访客模式”在其他事件循环之上运行 Trio</span></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/399">#399</a>)</p></li>
</ul>
</section>
<section id="id42">
<h3>Features<a class="headerlink" href="#id42" title="Link to this heading">¶</a></h3>
<ul>
<li><p>To speed up <cite>trio.to_thread.run_sync</cite>, Trio now caches and reuses
worker threads.</p>
<p>And in case you have some exotic use case where you need to spawn
threads manually, but want to take advantage of Trio's cache, you can
do that using the new <cite>trio.lowlevel.start_thread_soon</cite>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/6">#6</a>)</p>
</li>
<li><p>Tasks spawned with <cite>nursery.start() &lt;trio.Nursery.start&gt;</cite> aren't treated as
direct children of their nursery until they call <code class="docutils literal notranslate"><span class="pre">task_status.started()</span></code>.
This is visible through the task tree introspection attributes such as
<cite>Task.parent_nursery &lt;trio.lowlevel.Task.parent_nursery&gt;</cite>. Sometimes, though,
you want to know where the task is going to wind up, even if it hasn't finished
initializing yet. To support this, we added a new attribute
<cite>Task.eventual_parent_nursery &lt;trio.lowlevel.Task.eventual_parent_nursery&gt;</cite>.
For a task spawned with <a class="reference internal" href="ref-core/tasks.html#id0" title="trio.Nursery.start"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start()</span></code></a> that hasn't yet called
<code class="docutils literal notranslate"><span class="pre">started()</span></code>, this is the nursery that the task was nominally started in,
where it will be running once it finishes starting up. In all other cases,
it is <code class="docutils literal notranslate"><span class="pre">None</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1558">#1558</a>)</p></li>
</ul>
</section>
<section id="id43">
<h3>Bugfixes<a class="headerlink" href="#id43" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Added a helpful error message if an async function is passed to <cite>trio.to_thread.run_sync</cite>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1573">#1573</a>)</p></li>
</ul>
</section>
<section id="id44">
<h3>Deprecations and removals<a class="headerlink" href="#id44" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">BlockingTrioPortal</span></code>: it was deprecated in 0.12.0. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1574">#1574</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">tiebreaker</span></code> argument to <cite>trio.testing.wait_all_tasks_blocked</cite>
has been deprecated. This is a highly obscure feature that was
probably never used by anyone except <cite>trio.testing.MockClock</cite>, and
<cite>~trio.testing.MockClock</cite> doesn't need it anymore. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1587">#1587</a>)</p></li>
<li><p>Remove the deprecated <code class="docutils literal notranslate"><span class="pre">trio.ssl</span></code> and <code class="docutils literal notranslate"><span class="pre">trio.subprocess</span></code> modules. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1594">#1594</a>)</p></li>
</ul>
</section>
<section id="id45">
<h3>Miscellaneous internal changes<a class="headerlink" href="#id45" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>We refactored <cite>trio.testing.MockClock</cite> so that it no longer needs to
run an internal task to manage autojumping. This should be mostly
invisible to users, but there is one semantic change: the interaction
between <cite>trio.testing.wait_all_tasks_blocked</cite> and the autojump clock
was fixed. Now, the autojump will always wait until after all
<cite>~trio.testing.wait_all_tasks_blocked</cite> calls have finished before
firing, instead of it depending on which threshold values you passed. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1587">#1587</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-15-1-2020-05-22">
<h2>Trio 0.15.1 (2020-05-22)<a class="headerlink" href="#trio-0-15-1-2020-05-22" title="Link to this heading">¶</a></h2>
<section id="id46">
<h3>Bugfixes<a class="headerlink" href="#id46" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix documentation build. (This must be a new release tag to get readthedocs
"stable" to include the changes from 0.15.0.)</p></li>
<li><p>Added a helpful error message if an async function is passed to <cite>trio.from_thread.run_sync</cite> or a sync function to <cite>trio.from_thread.run</cite>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1244">#1244</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-15-0-2020-05-19">
<h2>Trio 0.15.0 (2020-05-19)<a class="headerlink" href="#trio-0-15-0-2020-05-19" title="Link to this heading">¶</a></h2>
<section id="id47">
<h3>Features<a class="headerlink" href="#id47" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Previously, when <cite>trio.run_process</cite> was cancelled, it always killed
the subprocess immediately. Now, on Unix, it first gives the process a
chance to clean up by sending <code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code>, and only escalates to
<code class="docutils literal notranslate"><span class="pre">SIGKILL</span></code> if the process is still running after 5 seconds. But if
you prefer the old behavior, or want to adjust the timeout, then don't
worry: you can now pass a custom <code class="docutils literal notranslate"><span class="pre">deliver_cancel=</span></code> argument to
define your own process killing policy. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1104">#1104</a>)</p></li>
<li><p>It turns out that creating a subprocess can block the parent process
for a surprisingly long time. So <code class="docutils literal notranslate"><span class="pre">trio.open_process</span></code> now uses a worker
thread to avoid blocking the event loop. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1109">#1109</a>)</p></li>
<li><p>We've added FreeBSD to the list of platforms we support and test on. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1118">#1118</a>)</p></li>
<li><p>On Linux kernels v5.3 or newer, <cite>trio.Process.wait</cite> now uses <a class="reference external" href="https://lwn.net/Articles/794707/">the
pidfd API</a> to track child
processes. This shouldn't have any user-visible change, but it makes
working with subprocesses faster and use less memory. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1241">#1241</a>)</p></li>
<li><p>The <cite>trio.Process.returncode</cite> attribute is now automatically updated
as needed, instead of only when you call <cite>~trio.Process.poll</cite> or
<cite>~trio.Process.wait</cite>. Also, <code class="docutils literal notranslate"><span class="pre">repr(process_object)</span></code> now always
contains up-to-date information about the process status. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1315">#1315</a>)</p></li>
</ul>
</section>
<section id="id48">
<h3>Bugfixes<a class="headerlink" href="#id48" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>On Ubuntu systems, the system Python includes a custom
unhandled-exception hook to perform <a class="reference external" href="https://wiki.ubuntu.com/Apport">crash reporting</a>. Unfortunately, Trio wants to use
the same hook to print nice <code class="docutils literal notranslate"><span class="pre">MultiError</span></code> tracebacks, causing a
conflict. Previously, Trio would detect the conflict, print a warning,
and you just wouldn't get nice <code class="docutils literal notranslate"><span class="pre">MultiError</span></code> tracebacks. Now, Trio has
gotten clever enough to integrate its hook with Ubuntu's, so the two
systems should Just Work together. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1065">#1065</a>)</p></li>
<li><p>Fixed an over-strict test that caused failures on Alpine Linux.
Started testing against Alpine in CI. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1499">#1499</a>)</p></li>
<li><p>Calling <cite>open_signal_receiver</cite> with no arguments used to succeed without listening for any signals. This was confusing, so now it raises TypeError instead. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1526">#1526</a>)</p></li>
</ul>
</section>
<section id="id49">
<h3>Deprecations and Removals<a class="headerlink" href="#id49" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Remove support for Python 3.5. (<a class="reference external" href="https://github.com/python-trio/trio/issues/75">#75</a>)</p></li>
<li><p>It turns out that everyone got confused by the name <code class="docutils literal notranslate"><span class="pre">trio.hazmat</span></code>.
So that name has been deprecated, and the new name is
<a class="reference internal" href="reference-lowlevel.html#module-trio.lowlevel" title="trio.lowlevel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.lowlevel</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/476">#476</a>)</p></li>
<li><p>Most of the public classes that Trio exports – like <cite>trio.Lock</cite>,
<cite>trio.SocketStream</cite>, and so on – weren't designed with subclassing in
mind. And we've noticed that some users were trying to subclass them
anyway, and ending up with fragile code that we're likely to
accidentally break in the future, or else be stuck unable to make
changes for fear of breaking subclasses.</p>
<p>There are also some classes that were explicitly designed to be
subclassed, like the ones in <code class="docutils literal notranslate"><span class="pre">trio.abc</span></code>. Subclassing these is still
supported. However, for all other classes, attempts to subclass will
now raise a deprecation warning, and in the future will raise an
error.</p>
<p>If this causes problems for you, feel free to drop by our <a class="reference external" href="https://gitter.im/python-trio/general">chat room</a> or file a bug, to discuss
alternatives or make a case for why some particular class should be
designed to support subclassing. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1044">#1044</a>)</p>
</li>
<li><p>If you want to create a <cite>trio.Process</cite> object, you now have to call
<code class="docutils literal notranslate"><span class="pre">trio.open_process</span></code>; calling <code class="docutils literal notranslate"><span class="pre">trio.Process()</span></code> directly was
deprecated in v0.12.0 and has now been removed. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1109">#1109</a>)</p></li>
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">clear</span></code> method on <cite>trio.Event</cite>: it was deprecated in 0.12.0. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1498">#1498</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-14-0-2020-04-27">
<h2>Trio 0.14.0 (2020-04-27)<a class="headerlink" href="#trio-0-14-0-2020-04-27" title="Link to this heading">¶</a></h2>
<section id="id50">
<h3>Features<a class="headerlink" href="#id50" title="Link to this heading">¶</a></h3>
<ul>
<li><p>If you're using Trio's low-level interfaces like
<cite>trio.hazmat.wait_readable &lt;trio.lowlevel.wait_readable&gt;</cite> or similar, and then you close a socket or
file descriptor, you're supposed to call <cite>trio.hazmat.notify_closing
&lt;trio.lowlevel.notify_closing&gt;</cite>
first so Trio can clean up properly. But what if you forget? In the
past, Trio would tend to either deadlock or explode spectacularly.
Now, it's much more robust to this situation, and should generally
survive. (But note that "survive" is not the same as "give you the
results you were expecting", so you should still call
<cite>~trio.lowlevel.notify_closing</cite> when appropriate. This is about harm
reduction and making it easier to debug this kind of mistake, not
something you should rely on.)</p>
<p>If you're using higher-level interfaces outside of the <cite>trio.hazmat &lt;trio.lowlevel&gt;</cite>
module, then you don't need to worry about any of this; those
interfaces already take care of calling <cite>~trio.lowlevel.notify_closing</cite>
for you. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1272">#1272</a>)</p>
</li>
</ul>
</section>
<section id="id51">
<h3>Bugfixes<a class="headerlink" href="#id51" title="Link to this heading">¶</a></h3>
<ul>
<li><p>A bug related to the following methods has been introduced in version 0.12.0:</p>
<ul class="simple">
<li><p><cite>trio.Path.iterdir</cite></p></li>
<li><p><cite>trio.Path.glob</cite></p></li>
<li><p><cite>trio.Path.rglob</cite></p></li>
</ul>
<p>The iteration of the blocking generators produced by pathlib was performed in
the trio thread. With this fix, the previous behavior is restored: the blocking
generators are converted into lists in a thread dedicated to blocking IO calls. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1308">#1308</a>)</p>
</li>
</ul>
</section>
<section id="id52">
<h3>Deprecations and Removals<a class="headerlink" href="#id52" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Deprecate Python 3.5 (<a class="reference external" href="https://github.com/python-trio/trio/pull/1408">#1408</a>)</p></li>
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">trio.open_cancel_scope</span></code> which was deprecated in 0.11.0. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1458">#1458</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-13-0-2019-11-02">
<h2>Trio 0.13.0 (2019-11-02)<a class="headerlink" href="#trio-0-13-0-2019-11-02" title="Link to this heading">¶</a></h2>
<section id="id53">
<h3>Features<a class="headerlink" href="#id53" title="Link to this heading">¶</a></h3>
<ul>
<li><p>On Windows, the <a class="reference external" href="https://docs.microsoft.com/en-us/windows/win32/fileio/i-o-completion-ports">IOCP subsystem</a>
is generally the best way to implement async I/O operations – but it's
historically been weak at providing <code class="docutils literal notranslate"><span class="pre">select</span></code>-style readiness
notifications, like <cite>trio.hazmat.wait_readable &lt;trio.lowlevel.wait_readable&gt;</cite> and
<cite>~trio.lowlevel.wait_writable</cite>. We aren't willing to give those up, so
previously Trio's Windows backend used a hybrid of <code class="docutils literal notranslate"><span class="pre">select</span></code> + IOCP.
This was complex, slow, and had <a class="reference external" href="https://github.com/python-trio/trio/issues/3">limited scalability</a>.</p>
<p>Fortunately, we found a way to implement <code class="docutils literal notranslate"><span class="pre">wait_*</span></code> with IOCP, so
Trio's Windows backend has been completely rewritten, and now uses
IOCP exclusively. As a user, the only difference you should notice is
that Trio should now be faster on Windows, and can handle many more
sockets. This also simplified the code internally, which should allow
for more improvements in the future.</p>
<p>However, this is somewhat experimental, so if you use Windows then
please keep an eye out and let us know if you run into any problems! (<a class="reference external" href="https://github.com/python-trio/trio/issues/52">#52</a>)</p>
</li>
<li><p>Use slots for memory channel state and statistics which should make memory channels slightly smaller and faster. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1195">#1195</a>)</p></li>
</ul>
</section>
<section id="id54">
<h3>Bugfixes<a class="headerlink" href="#id54" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>OpenSSL has a bug in its handling of TLS 1.3 session tickets that can
cause deadlocks or data loss in some rare edge cases. These edge cases
most frequently happen during tests. (Upstream bug reports: <a class="reference external" href="https://github.com/openssl/openssl/issues/7948">openssl/openssl#7948</a>, <a class="reference external" href="https://github.com/openssl/openssl/issues/7967">openssl/openssl#7967</a>.) <cite>trio.SSLStream</cite>
now works around this issue, so you don't have to worry about it. (<a class="reference external" href="https://github.com/python-trio/trio/issues/819">#819</a>)</p></li>
<li><p>Trio now uses <cite>signal.set_wakeup_fd</cite> on all platforms. This is mostly
an internal refactoring with no user-visible effect, but in theory it
should fix a few extremely-rare race conditions on Unix that could
have caused signal delivery to be delayed. (<a class="reference external" href="https://github.com/python-trio/trio/issues/109">#109</a>)</p></li>
<li><p>Trio no longer crashes when an async function is implemented in C or
Cython and then passed directly to <cite>trio.run</cite> or
<code class="docutils literal notranslate"><span class="pre">nursery.start_soon</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/550">#550</a>, <a class="reference external" href="https://github.com/python-trio/trio/issues/1191">#1191</a>)</p></li>
<li><p>When a Trio task makes improper use of a non-Trio async library, Trio now causes an exception to be raised within the task at the point of the error, rather than abandoning the task and raising an error in its parent. This improves debuggability and resolves the <cite>TrioInternalError</cite> that would sometimes result from the old strategy. (<a class="reference external" href="https://github.com/python-trio/trio/issues/552">#552</a>)</p></li>
<li><p>In 0.12.0 we deprecated <code class="docutils literal notranslate"><span class="pre">trio.run_sync_in_worker_thread</span></code> in favor of
<cite>trio.to_thread.run_sync</cite>. But, the deprecation message listed the
wrong name for the replacement. The message now gives the correct name. (<a class="reference external" href="https://github.com/python-trio/trio/issues/810">#810</a>)</p></li>
<li><p>Fix regression introduced with cancellation changes in 0.12.0, where a
<cite>trio.CancelScope</cite> which isn't cancelled could catch a propagating
<cite>trio.Cancelled</cite> exception if shielding were changed while the
cancellation was propagating. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1175">#1175</a>)</p></li>
<li><p>Fix a crash that could happen when using <code class="docutils literal notranslate"><span class="pre">MockClock</span></code> with autojump
enabled and a non-zero rate. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1190">#1190</a>)</p></li>
<li><p>If you nest &gt;1000 cancel scopes within each other, Trio now handles
that gracefully instead of crashing with a <code class="docutils literal notranslate"><span class="pre">RecursionError</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1235">#1235</a>)</p></li>
<li><p>Fixed the hash behavior of <cite>trio.Path</cite> to match <cite>pathlib.Path</cite>. Previously <cite>trio.Path</cite>'s hash was inherited from <cite>object</cite> instead of from <cite>pathlib.PurePath</cite>. Thus, hashing two <cite>trio.Path</cite>'s or a <cite>trio.Path</cite> and a <cite>pathlib.Path</cite> with the same underlying path would yield different results. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1259">#1259</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-12-1-2019-08-01">
<h2>Trio 0.12.1 (2019-08-01)<a class="headerlink" href="#trio-0-12-1-2019-08-01" title="Link to this heading">¶</a></h2>
<section id="id55">
<h3>Bugfixes<a class="headerlink" href="#id55" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>In v0.12.0, we accidentally moved <code class="docutils literal notranslate"><span class="pre">BlockingTrioPortal</span></code> from <code class="docutils literal notranslate"><span class="pre">trio</span></code>
to <code class="docutils literal notranslate"><span class="pre">trio.hazmat</span></code>. It's now been restored to its proper position.
(It's still deprecated though, and will issue a warning if you use it.) (<a class="reference external" href="https://github.com/python-trio/trio/issues/1167">#1167</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-12-0-2019-07-31">
<h2>Trio 0.12.0 (2019-07-31)<a class="headerlink" href="#trio-0-12-0-2019-07-31" title="Link to this heading">¶</a></h2>
<section id="id56">
<h3>Features<a class="headerlink" href="#id56" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>If you have a <cite>~trio.abc.ReceiveStream</cite> object, you can now use
<code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">for</span> <span class="pre">data</span> <span class="pre">in</span> <span class="pre">stream:</span> <span class="pre">...</span></code> instead of calling
<cite>~trio.abc.ReceiveStream.receive_some</cite>. Each iteration gives an
arbitrary sized chunk of bytes. And the best part is, the loop
automatically exits when you reach EOF, so you don't have to check for
it yourself anymore. Relatedly, you no longer need to pick a magic
buffer size value before calling
<cite>~trio.abc.ReceiveStream.receive_some</cite>; you can <code class="docutils literal notranslate"><span class="pre">await</span>
<span class="pre">stream.receive_some()</span></code> with no arguments, and the stream will
automatically pick a reasonable size for you. (<a class="reference external" href="https://github.com/python-trio/trio/issues/959">#959</a>)</p></li>
<li><p>Threading interfaces have been reworked:
<code class="docutils literal notranslate"><span class="pre">run_sync_in_worker_thread</span></code> is now <cite>trio.to_thread.run_sync</cite>, and
instead of <code class="docutils literal notranslate"><span class="pre">BlockingTrioPortal</span></code>, use <cite>trio.from_thread.run</cite> and
<cite>trio.from_thread.run_sync</cite>. What's neat about this is that these
cooperate, so if you're in a thread created by <cite>to_thread.run_sync</cite>,
it remembers which Trio created it, and you can call
<code class="docutils literal notranslate"><span class="pre">trio.from_thread.*</span></code> directly without having to pass around a
<code class="docutils literal notranslate"><span class="pre">BlockingTrioPortal</span></code> object everywhere. (<a class="reference external" href="https://github.com/python-trio/trio/issues/810">#810</a>)</p></li>
<li><p>We cleaned up the distinction between the "abstract channel interface"
and the "memory channel" concrete implementation.
<cite>trio.abc.SendChannel</cite> and <cite>trio.abc.ReceiveChannel</cite> have been slimmed
down, <cite>trio.MemorySendChannel</cite> and <cite>trio.MemoryReceiveChannel</cite> are now
public types that can be used in type hints, and there's a new
<cite>trio.abc.Channel</cite> interface for future bidirectional channels. (<a class="reference external" href="https://github.com/python-trio/trio/issues/719">#719</a>)</p></li>
<li><p>Add <a class="reference internal" href="ref-io/subprocess.html#trio.run_process" title="trio.run_process"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.run_process()</span></code></a> as a high-level helper for running a process
and waiting for it to finish, like the standard <a class="reference external" href="https://docs.python.org/zh-cn/3/library/subprocess.html#subprocess.run" title="（在 Python v3.13）"><code class="xref py py-func docutils literal notranslate"><span class="pre">subprocess.run()</span></code></a> does. (<a class="reference external" href="https://github.com/python-trio/trio/issues/822">#822</a>)</p></li>
<li><p>On Linux, when wrapping a bare file descriptor in a Trio socket object,
Trio now auto-detects the correct <code class="docutils literal notranslate"><span class="pre">family</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code>, and <code class="docutils literal notranslate"><span class="pre">protocol</span></code>.
This is useful, for example, when implementing <a class="reference external" href="http://0pointer.de/blog/projects/socket-activation.html">systemd socket activation</a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/251">#251</a>)</p></li>
<li><p>Trio sockets have a new method <cite>~trio.socket.SocketType.is_readable</cite> that allows
you to check whether a socket is readable. This is useful for HTTP/1.1 clients. (<a class="reference external" href="https://github.com/python-trio/trio/issues/760">#760</a>)</p></li>
<li><p>We no longer use runtime code generation to dispatch core functions
like <cite>current_time</cite>. Static analysis tools like mypy and pylint should
now be able to recognize and analyze all of Trio's top-level functions
(though some class attributes are still dynamic... we're working on it). (<a class="reference external" href="https://github.com/python-trio/trio/issues/805">#805</a>)</p></li>
<li><p>Add <cite>trio.hazmat.FdStream &lt;trio.lowlevel.FdStream&gt;</cite> for wrapping a Unix file descriptor as a <cite>~trio.abc.Stream</cite>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/829">#829</a>)</p></li>
<li><p>Trio now gives a reasonable traceback and error message in most cases
when its invariants surrounding cancel scope nesting have been
violated. (One common source of such violations is an async generator
that yields within a cancel scope.) The previous behavior was an
inscrutable chain of TrioInternalErrors. (<a class="reference external" href="https://github.com/python-trio/trio/issues/882">#882</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MultiError</span></code> now defines its <code class="docutils literal notranslate"><span class="pre">exceptions</span></code> attribute in <code class="docutils literal notranslate"><span class="pre">__init__()</span></code>
to better support linters and code autocompletion. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1066">#1066</a>)</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">__slots__</span></code> in more places internally, which should make Trio slightly faster. (<a class="reference external" href="https://github.com/python-trio/trio/issues/984">#984</a>)</p></li>
</ul>
</section>
<section id="id57">
<h3>Bugfixes<a class="headerlink" href="#id57" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Destructor methods (<code class="docutils literal notranslate"><span class="pre">__del__</span></code>) are now protected against <code class="docutils literal notranslate"><span class="pre">KeyboardInterrupt</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/676">#676</a>)</p></li>
<li><p>The <a class="reference internal" href="ref-io/async_file_io.html#trio.Path" title="trio.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.Path</span></code></a> methods <a class="reference internal" href="ref-io/async_file_io.html#trio.Path.glob" title="trio.Path.glob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">glob()</span></code></a> and
<a class="reference internal" href="ref-io/async_file_io.html#trio.Path.rglob" title="trio.Path.rglob"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rglob()</span></code></a> now return iterables of <a class="reference internal" href="ref-io/async_file_io.html#trio.Path" title="trio.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.Path</span></code></a>
(not <a class="reference external" href="https://docs.python.org/zh-cn/3/library/pathlib.html#pathlib.Path" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">pathlib.Path</span></code></a>). (<a class="reference external" href="https://github.com/python-trio/trio/issues/917">#917</a>)</p></li>
<li><p>Inspecting the <a class="reference internal" href="ref-core/cancel_timeout.html#id6" title="trio.CancelScope.cancel_called"><code class="xref py py-attr docutils literal notranslate"><span class="pre">cancel_called</span></code></a> attribute of a
not-yet-exited cancel scope whose deadline is in the past now always
returns <code class="docutils literal notranslate"><span class="pre">True</span></code>, like you might expect. (Previously it would return
<code class="docutils literal notranslate"><span class="pre">False</span></code> for not-yet-entered cancel scopes, and for active cancel
scopes until the first checkpoint after their deadline expiry.) (<a class="reference external" href="https://github.com/python-trio/trio/issues/958">#958</a>)</p></li>
<li><p>The <a class="reference internal" href="ref-io/async_file_io.html#trio.Path" title="trio.Path"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.Path</span></code></a> classmethods, <a class="reference internal" href="ref-io/async_file_io.html#trio.Path.home" title="trio.Path.home"><code class="xref py py-meth docutils literal notranslate"><span class="pre">home()</span></code></a> and
<a class="reference internal" href="ref-io/async_file_io.html#trio.Path.cwd" title="trio.Path.cwd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cwd()</span></code></a>, are now async functions.  Previously, a bug
in the forwarding logic meant <a class="reference internal" href="ref-io/async_file_io.html#trio.Path.cwd" title="trio.Path.cwd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cwd()</span></code></a> was synchronous
and <a class="reference internal" href="ref-io/async_file_io.html#trio.Path.home" title="trio.Path.home"><code class="xref py py-meth docutils literal notranslate"><span class="pre">home()</span></code></a> didn't work at all. (<a class="reference external" href="https://github.com/python-trio/trio/issues/960">#960</a>)</p></li>
<li><p>An exception encapsulated within a <code class="docutils literal notranslate"><span class="pre">MultiError</span></code> doesn't need to be
hashable anymore.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>This is only supported if you are running python &gt;= 3.6.4. You can
refer to <a class="reference external" href="https://github.com/python/cpython/pull/4014">this github PR</a>
for details. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1005">#1005</a>)</p>
</div>
</li>
</ul>
</section>
<section id="id58">
<h3>Improved Documentation<a class="headerlink" href="#id58" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>To help any user reading through Trio's function implementations, start using public names (not _core) whenever possible. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1017">#1017</a>)</p></li>
</ul>
</section>
<section id="id59">
<h3>Deprecations and Removals<a class="headerlink" href="#id59" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">clear</span></code> method on <cite>trio.Event</cite> has been deprecated. (<a class="reference external" href="https://github.com/python-trio/trio/issues/637">#637</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BlockingTrioPortal</span></code> has been deprecated in favor of the new
<cite>trio.from_thread</cite>.  (<a class="reference external" href="https://github.com/python-trio/trio/issues/810">#810</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">run_sync_in_worker_thread</span></code> is deprecated in favor of
<cite>trio.to_thread.run_sync</cite>.  (<a class="reference external" href="https://github.com/python-trio/trio/issues/810">#810</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">current_default_worker_thread_limiter</span></code> is deprecated in favor of
<cite>trio.to_thread.current_default_thread_limiter</cite>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/810">#810</a>)</p></li>
<li><p>Give up on trying to have different low-level waiting APIs on Unix and
Windows. All platforms now have <cite>trio.hazmat.wait_readable &lt;trio.lowlevel.wait_readable&gt;</cite>,
<cite>trio.hazmat.wait_writable &lt;trio.lowlevel.wait_writable&gt;</cite>, and
<cite>trio.hazmat.notify_closing &lt;trio.lowlevel.notify_closing&gt;</cite>. The old
platform-specific synonyms <code class="docutils literal notranslate"><span class="pre">wait_socket_*</span></code>,
<code class="docutils literal notranslate"><span class="pre">notify_socket_closing</span></code>, and <code class="docutils literal notranslate"><span class="pre">notify_fd_closing</span></code> have been
deprecated. (<a class="reference external" href="https://github.com/python-trio/trio/issues/878">#878</a>)</p></li>
<li><p>It turns out that it's better to treat subprocess spawning as an async
operation. Therefore, direct construction of <cite>Process</cite> objects has
been deprecated. Use <code class="docutils literal notranslate"><span class="pre">trio.open_process</span></code> instead. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1109">#1109</a>)</p></li>
</ul>
</section>
<section id="id60">
<h3>Miscellaneous internal changes<a class="headerlink" href="#id60" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The plumbing of Trio's cancellation system has been substantially overhauled
to improve performance and ease future planned improvements. Notably, there is
no longer any internal concept of a "cancel stack", and checkpoints now take
constant time regardless of the cancel scope nesting depth. (<a class="reference external" href="https://github.com/python-trio/trio/issues/58">#58</a>)</p></li>
<li><p>We've slightly relaxed our definition of which Trio operations act as
<a class="reference internal" href="ref-core/general_principles.html#checkpoint-rule"><span class="std std-ref">checkpoints</span></a>. A Trio async function that exits by
throwing an exception is no longer guaranteed to execute a checkpoint;
it might or might not. The rules are unchanged for async functions that
don't exit with an exception, async iterators, and async context managers.
<a class="reference internal" href="reference-testing.html#trio.testing.assert_checkpoints" title="trio.testing.assert_checkpoints"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.testing.assert_checkpoints()</span></code></a> has been updated to reflect the
new behavior: if its <code class="docutils literal notranslate"><span class="pre">with</span></code> block exits with an exception, no assertion
is made. (<a class="reference external" href="https://github.com/python-trio/trio/issues/474">#474</a>)</p></li>
<li><p>Calling <code class="docutils literal notranslate"><span class="pre">str</span></code> on a <a class="reference internal" href="ref-core/exc_warn.html#trio.Cancelled" title="trio.Cancelled"><code class="xref py py-exc docutils literal notranslate"><span class="pre">trio.Cancelled</span></code></a> exception object returns "Cancelled" instead of an empty string. (<a class="reference external" href="https://github.com/python-trio/trio/issues/674">#674</a>)</p></li>
<li><p>Change the default timeout in <a class="reference internal" href="ref-io/abs_api.html#trio.open_tcp_stream" title="trio.open_tcp_stream"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.open_tcp_stream()</span></code></a> to 0.250 seconds, for consistency with RFC 8305. (<a class="reference external" href="https://github.com/python-trio/trio/issues/762">#762</a>)</p></li>
<li><p>On win32 we no longer set SO_EXCLUSIVEADDRUSE when binding a socket in <a class="reference internal" href="ref-io/abs_api.html#trio.open_tcp_listeners" title="trio.open_tcp_listeners"><code class="xref py py-exc docutils literal notranslate"><span class="pre">trio.open_tcp_listeners</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/928">#928</a>)</p></li>
<li><p>Any attempt to inherit from <cite>CancelScope</cite> or <cite>Nursery</cite> now raises
<cite>TypeError</cite>.  (Trio has never been able to safely support subclassing
here; this change just makes it more obvious.)
Also exposed as public classes for type-checking, etc. (<a class="reference external" href="https://github.com/python-trio/trio/issues/1021">#1021</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-11-0-2019-02-09">
<h2>Trio 0.11.0 (2019-02-09)<a class="headerlink" href="#trio-0-11-0-2019-02-09" title="Link to this heading">¶</a></h2>
<section id="id61">
<h3>Features<a class="headerlink" href="#id61" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add support for "unbound cancel scopes": you can now construct a
<a class="reference internal" href="ref-core/cancel_timeout.html#trio.CancelScope" title="trio.CancelScope"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.CancelScope</span></code></a> without entering its context, e.g., so you
can pass it to another task which will use it to wrap some work that
you want to be able to cancel from afar. (<a class="reference external" href="https://github.com/python-trio/trio/issues/607">#607</a>)</p></li>
<li><p>The test suite now passes with openssl v1.1.1. Unfortunately this
required temporarily disabling TLS v1.3 during tests; see openssl bugs
<a class="reference external" href="https://github.com/openssl/openssl/issues/7948">#7948</a> and <a class="reference external" href="https://github.com/openssl/openssl/issues/7967">#7967</a>. We believe TLS
v1.3 should work in most real use cases, but will be monitoring the
situation. (<a class="reference external" href="https://github.com/python-trio/trio/issues/817">#817</a>)</p></li>
<li><p>Add <a class="reference internal" href="ref-io/subprocess.html#trio.Process.stdio" title="trio.Process.stdio"><code class="xref py py-attr docutils literal notranslate"><span class="pre">trio.Process.stdio</span></code></a>, which is a <a class="reference internal" href="ref-io/abs_api.html#trio.StapledStream" title="trio.StapledStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">StapledStream</span></code></a> of
<a class="reference internal" href="ref-io/subprocess.html#trio.Process.stdin" title="trio.Process.stdin"><code class="xref py py-attr docutils literal notranslate"><span class="pre">stdin</span></code></a> and <a class="reference internal" href="ref-io/subprocess.html#trio.Process.stdout" title="trio.Process.stdout"><code class="xref py py-attr docutils literal notranslate"><span class="pre">stdout</span></code></a> if both of those
are available, and <code class="docutils literal notranslate"><span class="pre">None</span></code> otherwise. This is intended to make it more
ergonomic to speak a back-and-forth protocol with a subprocess. (<a class="reference external" href="https://github.com/python-trio/trio/issues/862">#862</a>)</p></li>
<li><p><a class="reference internal" href="ref-io/subprocess.html#trio.Process" title="trio.Process"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.Process</span></code></a> on POSIX systems no longer accepts the error-prone
combination of <code class="docutils literal notranslate"><span class="pre">shell=False</span></code> with a <code class="docutils literal notranslate"><span class="pre">command</span></code> that's a single string,
or <code class="docutils literal notranslate"><span class="pre">shell=True</span></code> with a <code class="docutils literal notranslate"><span class="pre">command</span></code> that's a sequence of strings.
These forms are accepted by the underlying <a class="reference external" href="https://docs.python.org/zh-cn/3/library/subprocess.html#subprocess.Popen" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">subprocess.Popen</span></code></a>
constructor but don't do what most users expect. Also, added an explanation
of <a class="reference internal" href="ref-io/subprocess.html#subprocess-quoting"><span class="std std-ref">quoting</span></a> to the documentation. (<a class="reference external" href="https://github.com/python-trio/trio/issues/863">#863</a>)</p></li>
<li><p>Added an internal mechanism for pytest-trio's
<a class="reference external" href="https://hypothesis.readthedocs.io">Hypothesis</a> integration
to make the task scheduler reproducible and avoid flaky tests. (<a class="reference external" href="https://github.com/python-trio/trio/issues/890">#890</a>)</p></li>
<li><p><a class="reference internal" href="ref-io/abs_api.html#trio.abc.SendChannel" title="trio.abc.SendChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SendChannel</span></code></a>, <a class="reference internal" href="ref-io/abs_api.html#trio.abc.ReceiveChannel" title="trio.abc.ReceiveChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReceiveChannel</span></code></a>, <a class="reference internal" href="ref-io/abs_api.html#trio.abc.Listener" title="trio.abc.Listener"><code class="xref py py-class docutils literal notranslate"><span class="pre">Listener</span></code></a>,
and <a class="reference internal" href="ref-core/task_sync.html#trio.open_memory_channel" title="trio.open_memory_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_memory_channel()</span></code></a> can now be referenced using a generic type parameter
(the type of object sent over the channel or produced by the listener) using PEP 484 syntax:
<code class="docutils literal notranslate"><span class="pre">trio.abc.SendChannel[bytes]</span></code>, <code class="docutils literal notranslate"><span class="pre">trio.abc.Listener[trio.SocketStream]</span></code>,
<code class="docutils literal notranslate"><span class="pre">trio.open_memory_channel[MyMessage](5)</span></code>, etc. The added type information does not change
the runtime semantics, but permits better integration with external static type checkers. (<a class="reference external" href="https://github.com/python-trio/trio/issues/908">#908</a>)</p></li>
</ul>
</section>
<section id="id62">
<h3>Bugfixes<a class="headerlink" href="#id62" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fixed several bugs in the new Unix subprocess pipe support, where
(a) operations on a closed pipe could accidentally affect another
unrelated pipe due to internal file-descriptor reuse, (b) in very rare
circumstances, two tasks calling <code class="docutils literal notranslate"><span class="pre">send_all</span></code> on the same pipe at the
same time could end up with intermingled data instead of a
<a class="reference internal" href="ref-core/exc_warn.html#trio.BusyResourceError" title="trio.BusyResourceError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BusyResourceError</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/661">#661</a>)</p></li>
<li><p>Stop <a class="reference internal" href="ref-io/abs_api.html#trio.open_tcp_listeners" title="trio.open_tcp_listeners"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.open_tcp_listeners()</span></code></a> from crashing on systems that have
disabled IPv6. (<a class="reference external" href="https://github.com/python-trio/trio/issues/853">#853</a>)</p></li>
<li><p>Fixed support for multiple tasks calling <a class="reference internal" href="ref-io/subprocess.html#id6" title="trio.Process.wait"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trio.Process.wait()</span></code></a>
simultaneously; on kqueue platforms it would previously raise an exception. (<a class="reference external" href="https://github.com/python-trio/trio/issues/854">#854</a>)</p></li>
<li><p><a class="reference internal" href="ref-core/exc_warn.html#trio.Cancelled" title="trio.Cancelled"><code class="xref py py-exc docutils literal notranslate"><span class="pre">trio.Cancelled</span></code></a> exceptions now always propagate until they reach
the outermost unshielded cancelled scope, even if more cancellations
occur or shielding is changed between when the <a class="reference internal" href="ref-core/exc_warn.html#trio.Cancelled" title="trio.Cancelled"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Cancelled</span></code></a>
is delivered and when it is caught. (<a class="reference external" href="https://github.com/python-trio/trio/issues/860">#860</a>)</p></li>
<li><p>If you have a <a class="reference internal" href="ref-io/abs_api.html#trio.SocketStream" title="trio.SocketStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">SocketStream</span></code></a> that's already been closed, then
<code class="docutils literal notranslate"><span class="pre">await</span> <span class="pre">socket_stream.send_all(b"")</span></code> will now correctly raise
<a class="reference internal" href="ref-core/exc_warn.html#trio.ClosedResourceError" title="trio.ClosedResourceError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ClosedResourceError</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/874">#874</a>)</p></li>
<li><p>Simplified the Windows subprocess pipe <code class="docutils literal notranslate"><span class="pre">send_all</span></code> code, and in the
process fixed a theoretical bug where closing a pipe at just the wrong
time could produce errors or cause data to be redirected to the wrong
pipe. (<a class="reference external" href="https://github.com/python-trio/trio/issues/883">#883</a>)</p></li>
</ul>
</section>
<section id="id63">
<h3>Deprecations and Removals<a class="headerlink" href="#id63" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Deprecate <code class="docutils literal notranslate"><span class="pre">trio.open_cancel_scope</span></code> in favor of <a class="reference internal" href="ref-core/cancel_timeout.html#trio.CancelScope" title="trio.CancelScope"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.CancelScope</span></code></a>,
which more clearly reflects that creating a cancel scope is just an ordinary
object construction and does not need to be immediately paired with entering it. (<a class="reference external" href="https://github.com/python-trio/trio/issues/607">#607</a>)</p></li>
<li><p>The submodules <code class="docutils literal notranslate"><span class="pre">trio.ssl</span></code> and <code class="docutils literal notranslate"><span class="pre">trio.subprocess</span></code> are now deprecated.
Their nontrivial contents (<a class="reference internal" href="ref-io/subprocess.html#trio.Process" title="trio.Process"><code class="xref py py-class docutils literal notranslate"><span class="pre">Process</span></code></a>, <a class="reference internal" href="ref-io/abs_api.html#trio.SSLStream" title="trio.SSLStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSLStream</span></code></a>,
and <a class="reference internal" href="ref-io/abs_api.html#trio.SSLListener" title="trio.SSLListener"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSLListener</span></code></a>) have been moved to the main <a class="reference internal" href="ref-core/time_clock.html#module-trio" title="trio"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio</span></code></a>
namespace. For the numerous constants, exceptions, and other helpers
that were previously reexported from the standard <a class="reference external" href="https://docs.python.org/zh-cn/3/library/ssl.html#module-ssl" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ssl</span></code></a> and
<a class="reference external" href="https://docs.python.org/zh-cn/3/library/subprocess.html#module-subprocess" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> modules, you should now use those modules directly. (<a class="reference external" href="https://github.com/python-trio/trio/issues/852">#852</a>)</p></li>
<li><p>Remove all the APIs deprecated in 0.9.0 or earlier (<code class="docutils literal notranslate"><span class="pre">trio.Queue</span></code>,
<code class="docutils literal notranslate"><span class="pre">trio.catch_signals()</span></code>, <code class="docutils literal notranslate"><span class="pre">trio.BrokenStreamError</span></code>, and
<code class="docutils literal notranslate"><span class="pre">trio.ResourceBusyError</span></code>), except for <code class="docutils literal notranslate"><span class="pre">trio.hazmat.UnboundedQueue</span></code>,
which stays for now since it is used by the obscure lowlevel functions
<code class="docutils literal notranslate"><span class="pre">monitor_completion_queue()</span></code> and <code class="docutils literal notranslate"><span class="pre">monitor_kevent()</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/918">#918</a>)</p></li>
</ul>
</section>
<section id="id64">
<h3>Miscellaneous internal changes<a class="headerlink" href="#id64" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Entering a cancel scope whose deadline is in the past now immediately
cancels it, so <a class="reference internal" href="ref-core/exc_warn.html#trio.Cancelled" title="trio.Cancelled"><code class="xref py py-exc docutils literal notranslate"><span class="pre">Cancelled</span></code></a> will be raised by the first
checkpoint in the cancel scope rather than the second one.
This also affects constructs like <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">trio.move_on_after(0):</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/320">#320</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-10-0-2019-01-07">
<h2>Trio 0.10.0 (2019-01-07)<a class="headerlink" href="#trio-0-10-0-2019-01-07" title="Link to this heading">¶</a></h2>
<section id="id65">
<h3>Features<a class="headerlink" href="#id65" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Initial <a class="reference internal" href="ref-io/subprocess.html#subprocess"><span class="std std-ref">subprocess support</span></a>. Add
<a class="reference internal" href="ref-io/subprocess.html#trio.Process" title="trio.Process"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.subprocess.Process</span></code></a>, an async wrapper around the stdlib
<a class="reference external" href="https://docs.python.org/zh-cn/3/library/subprocess.html#subprocess.Popen" title="（在 Python v3.13）"><code class="xref py py-class docutils literal notranslate"><span class="pre">subprocess.Popen</span></code></a> class, which permits spawning subprocesses and
communicating with them over standard Trio streams. <code class="docutils literal notranslate"><span class="pre">trio.subprocess</span></code>
also reexports all the stdlib <a class="reference external" href="https://docs.python.org/zh-cn/3/library/subprocess.html#module-subprocess" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> exceptions and constants for
convenience. (<a class="reference external" href="https://github.com/python-trio/trio/issues/4">#4</a>)</p></li>
<li><p>You can now create an unbounded <a class="reference internal" href="ref-core/task_sync.html#trio.CapacityLimiter" title="trio.CapacityLimiter"><code class="xref py py-class docutils literal notranslate"><span class="pre">CapacityLimiter</span></code></a> by initializing with
<cite>math.inf</cite> (<a class="reference external" href="https://github.com/python-trio/trio/issues/618">#618</a>)</p></li>
<li><p>New <a class="reference internal" href="reference-lowlevel.html#module-trio.lowlevel" title="trio.lowlevel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.hazmat</span></code></a> features to allow cleanly switching live coroutine
objects between Trio and other coroutine runners. Frankly, we're not even
sure this is a good idea, but we want to <a class="reference external" href="https://github.com/python-trio/trio-asyncio/issues/42">try it out in trio-asyncio</a>, so here we are.
For details see <a class="reference internal" href="reference-lowlevel.html#live-coroutine-handoff"><span class="std std-ref">在协程运行器之间交接实时协程对象</span></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/649">#649</a>)</p></li>
</ul>
</section>
<section id="id66">
<h3>Bugfixes<a class="headerlink" href="#id66" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fixed a race condition on macOS, where Trio's TCP listener would crash if an
incoming TCP connection was closed before the listener had a chance to accept
it. (<a class="reference external" href="https://github.com/python-trio/trio/issues/609">#609</a>)</p></li>
<li><p><a class="reference internal" href="ref-io/abs_api.html#trio.open_tcp_stream" title="trio.open_tcp_stream"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.open_tcp_stream()</span></code></a> has been refactored to clean up unsuccessful
connection attempts more reliably. (<a class="reference external" href="https://github.com/python-trio/trio/issues/809">#809</a>)</p></li>
</ul>
</section>
<section id="id67">
<h3>Deprecations and Removals<a class="headerlink" href="#id67" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Remove the APIs deprecated in 0.5.0. (<code class="docutils literal notranslate"><span class="pre">ClosedStreamError</span></code>,
<code class="docutils literal notranslate"><span class="pre">ClosedListenerError</span></code>, <code class="docutils literal notranslate"><span class="pre">Result</span></code>) (<a class="reference external" href="https://github.com/python-trio/trio/issues/812">#812</a>)</p></li>
</ul>
</section>
<section id="id68">
<h3>Miscellaneous internal changes<a class="headerlink" href="#id68" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>There are a number of methods on <a class="reference internal" href="ref-io/abs_api.html#trio.SSLStream" title="trio.SSLStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.ssl.SSLStream</span></code></a>
that report information about the negotiated TLS connection, like
<code class="docutils literal notranslate"><span class="pre">selected_alpn_protocol</span></code>, and thus cannot succeed until after the handshake
has been performed. Previously, we returned None from these methods, like the
stdlib <a class="reference external" href="https://docs.python.org/zh-cn/3/library/ssl.html#module-ssl" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">ssl</span></code></a> module does, but this is confusing, because that can also
be a valid return value. Now we raise <a class="reference internal" href="ref-io/abs_api.html#trio.NeedHandshakeError" title="trio.NeedHandshakeError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">trio.ssl.NeedHandshakeError</span></code></a>
instead. (<a class="reference external" href="https://github.com/python-trio/trio/issues/735">#735</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-9-0-2018-10-12">
<h2>Trio 0.9.0 (2018-10-12)<a class="headerlink" href="#trio-0-9-0-2018-10-12" title="Link to this heading">¶</a></h2>
<section id="id69">
<h3>Features<a class="headerlink" href="#id69" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>New and improved APIs for inter-task communication:
<a class="reference internal" href="ref-io/abs_api.html#trio.abc.SendChannel" title="trio.abc.SendChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.abc.SendChannel</span></code></a>, <a class="reference internal" href="ref-io/abs_api.html#trio.abc.ReceiveChannel" title="trio.abc.ReceiveChannel"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.abc.ReceiveChannel</span></code></a>, and
<a class="reference internal" href="ref-core/task_sync.html#trio.open_memory_channel" title="trio.open_memory_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.open_memory_channel()</span></code></a> (which replaces <code class="docutils literal notranslate"><span class="pre">trio.Queue</span></code>). This
interface uses separate "sender" and "receiver" objects, for
consistency with other communication interfaces like
<a class="reference internal" href="ref-io/abs_api.html#trio.abc.Stream" title="trio.abc.Stream"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></a>. Also, the two objects can now be closed
individually, making it much easier to gracefully shut down a channel.
Also, check out the nifty <code class="docutils literal notranslate"><span class="pre">clone</span></code> API to make it easy to manage
shutdown in multiple-producer/multiple-consumer scenarios. Also, the
API has been written to allow for future channel implementations that
send objects across process boundaries. Also, it supports unbounded
buffering if you really need it. Also, help I can't stop writing also.
See <a class="reference internal" href="ref-core/task_sync.html#channels"><span class="std std-ref">使用通道在任务之间传递值</span></a> for more details. (<a class="reference external" href="https://github.com/python-trio/trio/issues/497">#497</a>)</p></li>
</ul>
</section>
<section id="id70">
<h3>Deprecations and Removals<a class="headerlink" href="#id70" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trio.Queue</span></code> and <code class="docutils literal notranslate"><span class="pre">trio.hazmat.UnboundedQueue</span></code> have been deprecated, in
favor of <a class="reference internal" href="ref-core/task_sync.html#trio.open_memory_channel" title="trio.open_memory_channel"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.open_memory_channel()</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/497">#497</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-8-0-2018-10-01">
<h2>Trio 0.8.0 (2018-10-01)<a class="headerlink" href="#trio-0-8-0-2018-10-01" title="Link to this heading">¶</a></h2>
<section id="id71">
<h3>Features<a class="headerlink" href="#id71" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Trio's default internal clock is now based on <a class="reference external" href="https://docs.python.org/zh-cn/3/library/time.html#time.perf_counter" title="（在 Python v3.13）"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.perf_counter()</span></code></a>
instead of <a class="reference external" href="https://docs.python.org/zh-cn/3/library/time.html#time.monotonic" title="（在 Python v3.13）"><code class="xref py py-func docutils literal notranslate"><span class="pre">time.monotonic()</span></code></a>. This makes time-keeping more precise on
Windows, and has no effect on other platforms. (<a class="reference external" href="https://github.com/python-trio/trio/issues/33">#33</a>)</p></li>
<li><p>Reworked <a class="reference internal" href="ref-core/time_clock.html#module-trio" title="trio"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio</span></code></a>, <a class="reference internal" href="reference-testing.html#module-trio.testing" title="trio.testing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.testing</span></code></a>, and <a class="reference internal" href="ref-io/low_level.html#module-trio.socket" title="trio.socket"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.socket</span></code></a> namespace
construction, making them more understandable by static analysis tools. This
should improve tab completion in editors, reduce false positives from pylint,
and is a first step towards providing type hints. (<a class="reference external" href="https://github.com/python-trio/trio/issues/542">#542</a>)</p></li>
</ul>
</section>
<section id="id72">
<h3>Deprecations and Removals<a class="headerlink" href="#id72" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ResourceBusyError</span></code> is now a deprecated alias for the new
<a class="reference internal" href="ref-core/exc_warn.html#trio.BusyResourceError" title="trio.BusyResourceError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BusyResourceError</span></code></a>, and <code class="docutils literal notranslate"><span class="pre">BrokenStreamError</span></code> is a deprecated alias for
the new <a class="reference internal" href="ref-core/exc_warn.html#trio.BrokenResourceError" title="trio.BrokenResourceError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">BrokenResourceError</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/620">#620</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-7-0-2018-09-03">
<h2>Trio 0.7.0 (2018-09-03)<a class="headerlink" href="#trio-0-7-0-2018-09-03" title="Link to this heading">¶</a></h2>
<section id="id73">
<h3>Features<a class="headerlink" href="#id73" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>The length of typical exception traces coming from Trio has been
greatly reduced. This was done by eliminating many of the exception
frames related to details of the implementation. For examples, see
the <a class="reference external" href="https://vorpus.org/blog/beautiful-tracebacks-in-trio-v070/">blog post</a>.
(<a class="reference external" href="https://github.com/python-trio/trio/issues/56">#56</a>)</p></li>
<li><p>New and improved signal catching API: <a class="reference internal" href="ref-io/signals.html#trio.open_signal_receiver" title="trio.open_signal_receiver"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_signal_receiver()</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/354">#354</a>)</p></li>
<li><p>The low level <code class="docutils literal notranslate"><span class="pre">trio.hazmat.wait_socket_readable</span></code>,
<code class="docutils literal notranslate"><span class="pre">wait_socket_writable</span></code>, and
<code class="docutils literal notranslate"><span class="pre">notify_socket_close</span></code> now work on bare socket descriptors,
instead of requiring a <a class="reference internal" href="ref-io/low_level.html#trio.socket.socket" title="trio.socket.socket"><code class="xref py py-func docutils literal notranslate"><span class="pre">socket.socket()</span></code></a> object. (<a class="reference external" href="https://github.com/python-trio/trio/issues/400">#400</a>)</p></li>
<li><p>If you're using <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.wait_task_rescheduled" title="trio.lowlevel.wait_task_rescheduled"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.hazmat.wait_task_rescheduled</span></code></a> and other low-level
routines to implement a new sleeping primitive, you can now use the new
<a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.Task.custom_sleep_data" title="trio.lowlevel.Task.custom_sleep_data"><code class="xref py py-data docutils literal notranslate"><span class="pre">trio.hazmat.Task.custom_sleep_data</span></code></a> attribute to pass arbitrary data
between the sleeping task, abort function, and waking task. (<a class="reference external" href="https://github.com/python-trio/trio/issues/616">#616</a>)</p></li>
</ul>
</section>
<section id="id74">
<h3>Bugfixes<a class="headerlink" href="#id74" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Prevent crashes when used with Sentry (raven-python). (<a class="reference external" href="https://github.com/python-trio/trio/issues/599">#599</a>)</p></li>
<li><p>The nursery context manager was rewritten to avoid use of
<code class="docutils literal notranslate"><span class="pre">@asynccontextmanager</span></code> and <code class="docutils literal notranslate"><span class="pre">@async_generator</span></code>. This reduces extraneous frames
in exception traces and addresses bugs regarding <cite>StopIteration</cite> and
<cite>StopAsyncIteration</cite> exceptions not propagating correctly. (<a class="reference external" href="https://github.com/python-trio/trio/issues/612">#612</a>)</p></li>
<li><p>Updates the formatting of exception messages raised by
<a class="reference internal" href="ref-io/abs_api.html#trio.open_tcp_stream" title="trio.open_tcp_stream"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.open_tcp_stream()</span></code></a> to correctly handle a hostname passed in as
bytes, by converting the hostname to a string. (<a class="reference external" href="https://github.com/python-trio/trio/issues/633">#633</a>)</p></li>
</ul>
</section>
<section id="id75">
<h3>Deprecations and Removals<a class="headerlink" href="#id75" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trio.catch_signals</span></code> has been deprecated in favor of
<a class="reference internal" href="ref-io/signals.html#trio.open_signal_receiver" title="trio.open_signal_receiver"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_signal_receiver()</span></code></a>. The main differences are: it takes
*-args now to specify the list of signals (so
<code class="docutils literal notranslate"><span class="pre">open_signal_receiver(SIGINT)</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">catch_signals({SIGINT})</span></code>), and, the async iterator now yields
individual signals, instead of "batches" (<a class="reference external" href="https://github.com/python-trio/trio/issues/354">#354</a>)</p></li>
<li><p>Remove all the APIs deprecated in 0.3.0 and 0.4.0. (<a class="reference external" href="https://github.com/python-trio/trio/issues/623">#623</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-6-0-2018-08-13">
<h2>Trio 0.6.0 (2018-08-13)<a class="headerlink" href="#trio-0-6-0-2018-08-13" title="Link to this heading">¶</a></h2>
<section id="id76">
<h3>Features<a class="headerlink" href="#id76" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.WaitForSingleObject" title="trio.lowlevel.WaitForSingleObject"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.hazmat.WaitForSingleObject</span></code></a> async function to await Windows
handles. (<a class="reference external" href="https://github.com/python-trio/trio/issues/233">#233</a>)</p></li>
<li><p>The <a class="reference external" href="https://github.com/python-trio/sniffio">sniffio</a> library can now
detect when Trio is running. (<a class="reference external" href="https://github.com/python-trio/trio/issues/572">#572</a>)</p></li>
</ul>
</section>
<section id="id77">
<h3>Bugfixes<a class="headerlink" href="#id77" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Make trio.socket._SocketType.connect <em>always</em> close the socket on
cancellation (<a class="reference external" href="https://github.com/python-trio/trio/issues/247">#247</a>)</p></li>
<li><p>Fix a memory leak in <a class="reference internal" href="ref-core/task_sync.html#trio.CapacityLimiter" title="trio.CapacityLimiter"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.CapacityLimiter</span></code></a>, that could occur when
<code class="docutils literal notranslate"><span class="pre">acquire</span></code> or <code class="docutils literal notranslate"><span class="pre">acquire_on_behalf_of</span></code> was cancelled. (<a class="reference external" href="https://github.com/python-trio/trio/issues/548">#548</a>)</p></li>
<li><p>Some version of macOS have a buggy <code class="docutils literal notranslate"><span class="pre">getaddrinfo</span></code> that was causing spurious
test failures; we now detect those systems and skip the relevant test when
found. (<a class="reference external" href="https://github.com/python-trio/trio/issues/580">#580</a>)</p></li>
<li><p>Prevent crashes when used with Sentry (raven-python). (<a class="reference external" href="https://github.com/python-trio/trio/issues/599">#599</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-5-0-2018-07-20">
<h2>Trio 0.5.0 (2018-07-20)<a class="headerlink" href="#trio-0-5-0-2018-07-20" title="Link to this heading">¶</a></h2>
<section id="id78">
<h3>Features<a class="headerlink" href="#id78" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Suppose one task is blocked trying to use a resource – for example, reading
from a socket – and while it's doing this, another task closes the resource.
Previously, this produced undefined behavior. Now, closing a resource causes
pending operations on that resource to terminate immediately with a
<a class="reference internal" href="ref-core/exc_warn.html#trio.ClosedResourceError" title="trio.ClosedResourceError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ClosedResourceError</span></code></a>. <code class="docutils literal notranslate"><span class="pre">ClosedStreamError</span></code> and <code class="docutils literal notranslate"><span class="pre">ClosedListenerError</span></code>
are now aliases for <a class="reference internal" href="ref-core/exc_warn.html#trio.ClosedResourceError" title="trio.ClosedResourceError"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ClosedResourceError</span></code></a>, and deprecated. For this to
work, Trio needs to know when a resource has been closed. To facilitate this,
new functions have been added: <code class="docutils literal notranslate"><span class="pre">trio.hazmat.notify_fd_close</span></code> and
<code class="docutils literal notranslate"><span class="pre">trio.hazmat.notify_socket_close</span></code>. If you're using Trio's built-in
wrappers like <a class="reference internal" href="ref-io/abs_api.html#trio.SocketStream" title="trio.SocketStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">SocketStream</span></code></a> or <a class="reference internal" href="ref-io/low_level.html#module-trio.socket" title="trio.socket"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.socket</span></code></a>, then you don't
need to worry about this, but if you're using the low-level functions like
<a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.wait_readable" title="trio.lowlevel.wait_readable"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.hazmat.wait_readable</span></code></a>, you should make sure to call these
functions at appropriate times. (<a class="reference external" href="https://github.com/python-trio/trio/issues/36">#36</a>)</p></li>
<li><p>Tasks created by <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.spawn_system_task" title="trio.lowlevel.spawn_system_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">spawn_system_task()</span></code></a> now no longer inherit
the creator's <a class="reference external" href="https://docs.python.org/zh-cn/3/library/contextvars.html#module-contextvars" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">contextvars</span></code></a> context, instead using one created at
<a class="reference internal" href="ref-core/run.html#trio.run" title="trio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/289">#289</a>)</p></li>
<li><p>Add support for <code class="docutils literal notranslate"><span class="pre">trio.Queue</span></code> with <code class="docutils literal notranslate"><span class="pre">capacity=0</span></code>. Queue's implementation
is also faster now. (<a class="reference external" href="https://github.com/python-trio/trio/issues/473">#473</a>)</p></li>
<li><p>Switch to using standalone <a class="reference external" href="https://github.com/python-trio/outcome">Outcome</a> library for Result objects.
(<a class="reference external" href="https://github.com/python-trio/trio/issues/494">#494</a>)</p></li>
</ul>
</section>
<section id="id79">
<h3>Deprecations and Removals<a class="headerlink" href="#id79" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trio.hazmat.Result</span></code>, <code class="docutils literal notranslate"><span class="pre">trio.hazmat.Value</span></code> and
<code class="docutils literal notranslate"><span class="pre">trio.hazmat.Error</span></code> have been replaced by the equivalent
classes in the <a class="reference external" href="https://github.com/python-trio/outcome">Outcome</a> library.</p></li>
</ul>
</section>
</section>
<section id="trio-0-4-0-2018-04-10">
<h2>Trio 0.4.0 (2018-04-10)<a class="headerlink" href="#trio-0-4-0-2018-04-10" title="Link to this heading">¶</a></h2>
<section id="id80">
<h3>Features<a class="headerlink" href="#id80" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Add unix client socket support. (<a class="reference external" href="https://github.com/python-trio/trio/issues/401">#401</a>)</p></li>
<li><p>Add support for <a class="reference external" href="https://docs.python.org/zh-cn/3/library/contextvars.html#module-contextvars" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">contextvars</span></code></a> (see <a class="reference internal" href="ref-core/task_local_storeage.html#task-local-storage"><span class="std std-ref">task-local storage</span></a>), and add <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.RunVar" title="trio.lowlevel.RunVar"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.hazmat.RunVar</span></code></a> as a similar API
for run-local variables. Deprecate <code class="docutils literal notranslate"><span class="pre">trio.TaskLocal</span></code> and
<code class="docutils literal notranslate"><span class="pre">trio.hazmat.RunLocal</span></code> in favor of these new APIs. (<a class="reference external" href="https://github.com/python-trio/trio/issues/420">#420</a>)</p></li>
<li><p>Add <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.current_root_task" title="trio.lowlevel.current_root_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.hazmat.current_root_task</span></code></a> to get the root task. (<a class="reference external" href="https://github.com/python-trio/trio/issues/452">#452</a>)</p></li>
</ul>
</section>
<section id="id81">
<h3>Bugfixes<a class="headerlink" href="#id81" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fix KeyboardInterrupt handling when threading state has been modified by a
3rd-party library. (<a class="reference external" href="https://github.com/python-trio/trio/issues/461">#461</a>)</p></li>
</ul>
</section>
<section id="id82">
<h3>Deprecations and Removals<a class="headerlink" href="#id82" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Attempting to explicitly raise <a class="reference internal" href="ref-core/exc_warn.html#trio.Cancelled" title="trio.Cancelled"><code class="xref py py-exc docutils literal notranslate"><span class="pre">trio.Cancelled</span></code></a> will cause a <a class="reference external" href="https://docs.python.org/zh-cn/3/library/exceptions.html#RuntimeError" title="（在 Python v3.13）"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a>.
<a class="reference internal" href="ref-core/cancel_timeout.html#id0" title="trio.CancelScope.cancel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cancel_scope.cancel()</span></code></a> should
be used instead. (<a class="reference external" href="https://github.com/python-trio/trio/issues/342">#342</a>)</p></li>
</ul>
</section>
<section id="id83">
<h3>Miscellaneous internal changes<a class="headerlink" href="#id83" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Simplify implementation of primitive traps like <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.wait_task_rescheduled" title="trio.lowlevel.wait_task_rescheduled"><code class="xref py py-func docutils literal notranslate"><span class="pre">wait_task_rescheduled()</span></code></a>
(<a class="reference external" href="https://github.com/python-trio/trio/issues/395">#395</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-3-0-2017-12-28">
<h2>Trio 0.3.0 (2017-12-28)<a class="headerlink" href="#trio-0-3-0-2017-12-28" title="Link to this heading">¶</a></h2>
<section id="id84">
<h3>Features<a class="headerlink" href="#id84" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>Simplified nurseries</strong>: In Trio, the rule used to be that "parenting is a
full time job", meaning that after a task opened a nursery and spawned some
children into it, it had to immediately block in <code class="docutils literal notranslate"><span class="pre">__aexit__</span></code> to supervise
the new children, or else exception propagation wouldn't work. Also there was
some elaborate machinery to let you replace this supervision logic with your
own custom supervision logic. Thanks to new advances in task-rearing
technology, <strong>parenting is no longer a full time job!</strong> Now the supervision
happens automatically in the background, and essentially the body of a
<code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">with</span> <span class="pre">trio.open_nursery()</span></code> block acts just like a task running inside
the nursery. This is important: it makes it possible for libraries to
abstract over nursery creation. For example, if you have a Websocket library
that needs to run a background task to handle Websocket pings, you can now do
that with <code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">with</span> <span class="pre">open_websocket(...)</span> <span class="pre">as</span> <span class="pre">ws:</span> <span class="pre">...</span></code>, and that can run a
task in the background without your users having to worry about parenting it.
And don't worry, you can still make custom supervisors; it turned out all
that spiffy machinery was actually redundant and didn't provide much value.
(<a class="reference external" href="https://github.com/python-trio/trio/issues/136">#136</a>)</p></li>
<li><p>Trio socket methods like <code class="docutils literal notranslate"><span class="pre">bind</span></code> and <code class="docutils literal notranslate"><span class="pre">connect</span></code> no longer require
"pre-resolved" numeric addresses; you can now pass regular hostnames and Trio
will implicitly resolve them for you. (<a class="reference external" href="https://github.com/python-trio/trio/issues/377">#377</a>)</p></li>
</ul>
</section>
<section id="id85">
<h3>Bugfixes<a class="headerlink" href="#id85" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Fixed some corner cases in Trio socket method implicit name resolution to
better match stdlib behavior. Example: <code class="docutils literal notranslate"><span class="pre">sock.bind(("",</span> <span class="pre">port))</span></code> now binds to
the wildcard address instead of raising an error. (<a class="reference external" href="https://github.com/python-trio/trio/issues/277">#277</a>)</p></li>
</ul>
</section>
<section id="id86">
<h3>Deprecations and Removals<a class="headerlink" href="#id86" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Removed everything that was deprecated in 0.2.0; see the 0.2.0
release notes below for details.</p></li>
<li><p>As was foretold in the v0.2.0 release notes, the <code class="docutils literal notranslate"><span class="pre">bind</span></code> method on Trio
sockets is now async. Please update your calls or – better yet – switch to
our shiny new high-level networking API, like <a class="reference internal" href="ref-io/abs_api.html#trio.serve_tcp" title="trio.serve_tcp"><code class="xref py py-func docutils literal notranslate"><span class="pre">serve_tcp()</span></code></a>. (<a class="reference external" href="https://github.com/python-trio/trio/issues/241">#241</a>)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">resolve_local_address</span></code> and <code class="docutils literal notranslate"><span class="pre">resolve_remote_address</span></code> methods
on Trio sockets have been deprecated; these are unnecessary now that
you can just pass your hostnames directly to the socket methods you
want to use. (<a class="reference external" href="https://github.com/python-trio/trio/issues/377">#377</a>)</p></li>
</ul>
</section>
</section>
<section id="trio-0-2-0-2017-12-06">
<h2>Trio 0.2.0 (2017-12-06)<a class="headerlink" href="#trio-0-2-0-2017-12-06" title="Link to this heading">¶</a></h2>
<p>Trio 0.2.0 contains changes from 14 contributors, and brings major new
features and bug fixes, as well as a number of deprecations and a very
small number of backwards incompatible changes. We anticipate that
these should be easy to adapt to, but make sure to read about them
below, and if you're using Trio then remember to <a class="reference external" href="https://github.com/python-trio/trio/issues/1">read and subscribe
to issue #1</a>.</p>
<section id="highlights">
<h3>Highlights<a class="headerlink" href="#highlights" title="Link to this heading">¶</a></h3>
<ul>
<li><p>Added a comprehensive API for async filesystem I/O: see
<a class="reference internal" href="ref-io/async_file_io.html#async-file-io"><span class="std std-ref">异步文件系统 I/O</span></a> (<a class="reference external" href="https://github.com/python-trio/trio/pull/20">gh-20</a>)</p></li>
<li><p>The new nursery <a class="reference internal" href="ref-core/tasks.html#id0" title="trio.Nursery.start"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start()</span></code></a> method makes it
easy to perform controlled start-up of long-running tasks. For
example, given an appropriate <code class="docutils literal notranslate"><span class="pre">http_server_on_random_open_port</span></code>
function, you could write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">port</span> <span class="o">=</span> <span class="k">await</span> <span class="n">nursery</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">http_server_on_random_open_port</span><span class="p">)</span>
</pre></div>
</div>
<p>and this would start the server running in the background in the
nursery, and then give you back the random port it selected – but
not until it had finished initializing and was ready to accept
requests!</p>
</li>
<li><p>Added a <a class="reference internal" href="ref-io/abs_api.html#abstract-stream-api"><span class="std std-ref">new abstract API for byte streams</span></a>, and <a class="reference internal" href="reference-testing.html#module-trio.testing" title="trio.testing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.testing</span></code></a> gained helpers for
creating fake streams for <a class="reference internal" href="reference-testing.html#virtual-streams"><span class="std std-ref">testing your protocol implementation</span></a> and checking that your custom stream
implementation <a class="reference internal" href="reference-testing.html#testing-custom-streams"><span class="std std-ref">follows the stream contract</span></a>.</p></li>
<li><p>If you're currently using <a class="reference internal" href="ref-io/low_level.html#module-trio.socket" title="trio.socket"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.socket</span></code></a> then you should
<a class="reference internal" href="ref-io/abs_api.html#high-level-networking"><span class="std std-ref">switch to using our new high-level networking API instead</span></a>. It takes care of many tiresome details, it's
fully integrated with the abstract stream API, and it provides
niceties like a state-of-the-art <a class="reference external" href="https://en.wikipedia.org/wiki/Happy_Eyeballs">Happy Eyeballs implementation</a> in
<a class="reference internal" href="ref-io/abs_api.html#trio.open_tcp_stream" title="trio.open_tcp_stream"><code class="xref py py-func docutils literal notranslate"><span class="pre">open_tcp_stream()</span></code></a> and server helpers that integrate with
<code class="docutils literal notranslate"><span class="pre">nursery.start</span></code>.</p></li>
<li><p>We've also added comprehensive support for SSL/TLS encryption,
including SNI (both client and server side), STARTTLS, renegotiation
during full-duplex usage (subject to OpenSSL limitations), and
applying encryption to arbitrary <a class="reference internal" href="ref-io/abs_api.html#trio.abc.Stream" title="trio.abc.Stream"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stream</span></code></a>s, which
allows for interesting applications like <a class="reference external" href="https://daniel.haxx.se/blog/2016/11/26/https-proxy-with-curl/">TLS-over-TLS</a>.
See: <a class="reference internal" href="ref-io/abs_api.html#trio.open_ssl_over_tcp_stream" title="trio.open_ssl_over_tcp_stream"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.open_ssl_over_tcp_stream()</span></code></a>,
<a class="reference internal" href="ref-io/abs_api.html#trio.serve_ssl_over_tcp" title="trio.serve_ssl_over_tcp"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.serve_ssl_over_tcp()</span></code></a>,
<a class="reference internal" href="ref-io/abs_api.html#trio.open_ssl_over_tcp_listeners" title="trio.open_ssl_over_tcp_listeners"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.open_ssl_over_tcp_listeners()</span></code></a>, and <code class="docutils literal notranslate"><span class="pre">trio.ssl</span></code>.</p>
<p>Interesting fact: the test suite for <code class="docutils literal notranslate"><span class="pre">trio.ssl</span></code> has so far
found bugs in CPython's ssl module, PyPy's ssl module, PyOpenSSL,
and OpenSSL. (<code class="docutils literal notranslate"><span class="pre">trio.ssl</span></code> doesn't use PyOpenSSL.) Trio's test
suite is fairly thorough.</p>
</li>
<li><p>You know thread-local storage? Well, Trio now has an equivalent:
<a class="reference internal" href="ref-core/task_local_storeage.html#task-local-storage"><span class="std std-ref">task-local storage</span></a>. There's also the
related, but more obscure, run-local storage; see
<code class="xref py py-class docutils literal notranslate"><span class="pre">RunLocal</span></code>. (<a class="reference external" href="https://github.com/python-trio/trio/pull/2">#2</a>)</p></li>
<li><p>Added a new <a class="reference internal" href="contributing.html#contributing"><span class="std std-ref">guide to for contributors</span></a>.</p></li>
</ul>
</section>
<section id="breaking-changes-and-deprecations">
<h3>Breaking changes and deprecations<a class="headerlink" href="#breaking-changes-and-deprecations" title="Link to this heading">¶</a></h3>
<p>Trio is a young and ambitious project, but it also aims to become a
stable, production-quality foundation for async I/O in Python.
Therefore, our approach for now is to provide deprecation warnings
where-ever possible, but on a fairly aggressive cycle as we push
towards stability. If you use Trio you should <a class="reference external" href="https://github.com/python-trio/trio/issues/1">read and subscribe to
issue #1</a>. We'd also
welcome feedback on how this approach is working, whether our
deprecation warnings could be more helpful, or anything else.</p>
<p>The tl;dr is: stop using <code class="docutils literal notranslate"><span class="pre">socket.bind</span></code> if you can, and then fix
everything your test suite warns you about.</p>
<p>Upcoming breaking changes without warnings (i.e., stuff that works in
0.2.0, but won't work in 0.3.0):</p>
<ul class="simple">
<li><p>In the next release, the <code class="docutils literal notranslate"><span class="pre">bind</span></code> method on Trio socket objects will
become async (<a class="reference external" href="https://github.com/python-trio/trio/issues/241">#241</a>). Unfortunately,
there's no good way to provide a warning here. We recommend
switching to the new highlevel networking APIs like
<a class="reference internal" href="ref-io/abs_api.html#trio.serve_tcp" title="trio.serve_tcp"><code class="xref py py-func docutils literal notranslate"><span class="pre">serve_tcp()</span></code></a>, which will insulate you from this change.</p></li>
</ul>
<p>Breaking changes (i.e., stuff that could theoretically break a program
that worked on 0.1.0):</p>
<ul class="simple">
<li><p><a class="reference internal" href="ref-io/low_level.html#module-trio.socket" title="trio.socket"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.socket</span></code></a> no longer attempts to normalize or modernize
socket options across different platforms. The high-level networking
API now handles that, freeing <a class="reference internal" href="ref-io/low_level.html#module-trio.socket" title="trio.socket"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.socket</span></code></a> to focus on giving
you raw, unadulterated BSD sockets.</p></li>
<li><p>When a socket <code class="docutils literal notranslate"><span class="pre">sendall</span></code> call was cancelled, it used to attach some
metadata to the exception reporting how much data was actually sent.
It no longer does this, because in common configurations like an
<a class="reference internal" href="ref-io/abs_api.html#trio.SSLStream" title="trio.SSLStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">SSLStream</span></code></a> wrapped around a
<a class="reference internal" href="ref-io/abs_api.html#trio.SocketStream" title="trio.SocketStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">SocketStream</span></code></a> it becomes ambiguous which "level" the
partial metadata applies to, leading to confusion and bugs. There is
no longer any way to tell how much data was sent after a <code class="docutils literal notranslate"><span class="pre">sendall</span></code>
is cancelled.</p></li>
<li><p>The <a class="reference internal" href="ref-io/low_level.html#trio.socket.getprotobyname" title="trio.socket.getprotobyname"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.socket.getprotobyname()</span></code></a> function is now async, like
it should have been all along. I doubt anyone will ever use it, but
that's no reason not to get the details right.</p></li>
<li><p>The <a class="reference internal" href="ref-io/low_level.html#module-trio.socket" title="trio.socket"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.socket</span></code></a> functions <code class="docutils literal notranslate"><span class="pre">getservbyport</span></code>,
<code class="docutils literal notranslate"><span class="pre">getservbyname</span></code>, and <code class="docutils literal notranslate"><span class="pre">getfqdn</span></code> have been removed, because they
were obscure, buggy, and obsolete. Use
<a class="reference internal" href="ref-io/low_level.html#trio.socket.getaddrinfo" title="trio.socket.getaddrinfo"><code class="xref py py-func docutils literal notranslate"><span class="pre">getaddrinfo()</span></code></a> instead.</p></li>
</ul>
<p>Upcoming breaking changes with warnings (i.e., stuff that in 0.2.0
<em>will</em> work but will print loud complaints, and that won't work in
0.3.0):</p>
<ul>
<li><p>For consistency with the new <code class="docutils literal notranslate"><span class="pre">start</span></code> method, the nursery <code class="docutils literal notranslate"><span class="pre">spawn</span></code>
method is being renamed to <code class="docutils literal notranslate"><span class="pre">start_soon</span></code> (<a class="reference external" href="https://github.com/python-trio/trio/issues/284">#284</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.socket.sendall</span></code> is deprecated; use <code class="docutils literal notranslate"><span class="pre">trio.open_tcp_stream</span></code>
and <code class="docutils literal notranslate"><span class="pre">SocketStream.send_all</span></code> instead (<a class="reference external" href="https://github.com/python-trio/trio/issues/291">#291</a>)</p></li>
<li><p>Trio now consistently uses <code class="docutils literal notranslate"><span class="pre">run</span></code> for functions that take and run
an async function (like <a class="reference internal" href="ref-core/run.html#trio.run" title="trio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.run()</span></code></a>!), and <code class="docutils literal notranslate"><span class="pre">run_sync</span></code> for
functions that take and run a synchronous function. As part of this:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">run_in_worker_thread</span></code> is becoming
<code class="docutils literal notranslate"><span class="pre">run_sync_in_worker_thread</span></code></p></li>
<li><p>We took the opportunity to refactor <code class="docutils literal notranslate"><span class="pre">run_in_trio_thread</span></code> and
<code class="docutils literal notranslate"><span class="pre">await_in_trio_thread</span></code> into the new class
<code class="docutils literal notranslate"><span class="pre">trio.BlockingTrioPortal</span></code></p></li>
<li><p>The hazmat function <code class="docutils literal notranslate"><span class="pre">current_call_soon_thread_and_signal_safe</span></code>
is being replaced by <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.TrioToken" title="trio.lowlevel.TrioToken"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.hazmat.TrioToken</span></code></a></p></li>
</ul>
<p>See <a class="reference external" href="https://github.com/python-trio/trio/issues/68">#68</a> for
details.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.Queue</span></code>'s <code class="docutils literal notranslate"><span class="pre">join</span></code> and <code class="docutils literal notranslate"><span class="pre">task_done</span></code> methods are
deprecated without replacement (<a class="reference external" href="https://github.com/python-trio/trio/issues/321">#321</a>)</p></li>
<li><p>Trio 0.1.0 provided a set of built-in mechanisms for waiting for and
tracking the result of individual tasks. We haven't yet found any
cases where using this actually led to simpler code, though, and
this feature is blocking useful improvements, so the following are
being deprecated without replacement:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nursery.zombies</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nursery.monitor</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nursery.reap</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nursery.reap_and_unwrap</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">task.result</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">task.add_monitor</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">task.discard_monitor</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">task.wait</span></code></p></li>
</ul>
<p>This also lets us move a number of lower-level features out of the
main <a class="reference internal" href="ref-core/time_clock.html#module-trio" title="trio"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio</span></code></a> namespace and into <a class="reference internal" href="reference-lowlevel.html#module-trio.lowlevel" title="trio.lowlevel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.hazmat</span></code></a>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trio.Task</span></code> → <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.Task" title="trio.lowlevel.Task"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.hazmat.Task</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.current_task</span></code> → <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.current_task" title="trio.lowlevel.current_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.hazmat.current_task</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.Result</span></code> → <code class="docutils literal notranslate"><span class="pre">trio.hazmat.Result</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.Value</span></code> → <code class="docutils literal notranslate"><span class="pre">trio.hazmat.Value</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.Error</span></code> → <code class="docutils literal notranslate"><span class="pre">trio.hazmat.Error</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.UnboundedQueue</span></code> → <code class="docutils literal notranslate"><span class="pre">trio.hazmat.UnboundedQueue</span></code></p></li>
</ul>
<p>In addition, several introspection attributes are being renamed:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nursery.children</span></code> → <code class="docutils literal notranslate"><span class="pre">nursery.child_tasks</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">task.parent_task</span></code> → use <code class="docutils literal notranslate"><span class="pre">task.parent_nursery.parent_task</span></code> instead</p></li>
</ul>
<p>See <a class="reference external" href="https://github.com/python-trio/trio/issues/136">#136</a> for
more details.</p>
</li>
<li><p>To consolidate introspection functionality in <a class="reference internal" href="reference-lowlevel.html#module-trio.lowlevel" title="trio.lowlevel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.hazmat</span></code></a>,
the following functions are moving:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">trio.current_clock</span></code> → <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.current_clock" title="trio.lowlevel.current_clock"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.hazmat.current_clock</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.current_statistics</span></code> →
<a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.current_statistics" title="trio.lowlevel.current_statistics"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.hazmat.current_statistics</span></code></a></p></li>
</ul>
<p>See <a class="reference external" href="https://github.com/python-trio/trio/issues/317">#317</a> for
more details.</p>
</li>
<li><p>It was decided that 0.1.0's "yield point" terminology was confusing;
we now use <a class="reference internal" href="ref-core/general_principles.html#checkpoints"><span class="std std-ref">"checkpoint"</span></a> instead. As part of
this, the following functions in <a class="reference internal" href="reference-lowlevel.html#module-trio.lowlevel" title="trio.lowlevel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.hazmat</span></code></a> are changing
names:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">yield_briefly</span></code> → <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.checkpoint" title="trio.lowlevel.checkpoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">~trio.hazmat.checkpoint</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">yield_briefly_no_cancel</span></code> → <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.cancel_shielded_checkpoint" title="trio.lowlevel.cancel_shielded_checkpoint"><code class="xref py py-func docutils literal notranslate"><span class="pre">cancel_shielded_checkpoint()</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">yield_if_cancelled</span></code> → <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.checkpoint_if_cancelled" title="trio.lowlevel.checkpoint_if_cancelled"><code class="xref py py-func docutils literal notranslate"><span class="pre">checkpoint_if_cancelled()</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">yield_indefinitely</span></code> → <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.wait_task_rescheduled" title="trio.lowlevel.wait_task_rescheduled"><code class="xref py py-func docutils literal notranslate"><span class="pre">wait_task_rescheduled()</span></code></a></p></li>
</ul>
<p>In addition, the following functions in <a class="reference internal" href="reference-testing.html#module-trio.testing" title="trio.testing"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.testing</span></code></a> are
changing names:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">assert_yields</span></code> → <a class="reference internal" href="reference-testing.html#trio.testing.assert_checkpoints" title="trio.testing.assert_checkpoints"><code class="xref py py-func docutils literal notranslate"><span class="pre">assert_checkpoints()</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assert_no_yields</span></code> → <a class="reference internal" href="reference-testing.html#trio.testing.assert_no_checkpoints" title="trio.testing.assert_no_checkpoints"><code class="xref py py-func docutils literal notranslate"><span class="pre">assert_no_checkpoints()</span></code></a></p></li>
</ul>
<p>See <a class="reference external" href="https://github.com/python-trio/trio/issues/157">#157</a> for
more details.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.format_exception</span></code> is deprecated; use
<a class="reference external" href="https://docs.python.org/zh-cn/3/library/traceback.html#traceback.format_exception" title="（在 Python v3.13）"><code class="xref py py-func docutils literal notranslate"><span class="pre">traceback.format_exception()</span></code></a> instead (<a class="reference external" href="https://github.com/python-trio/trio/pull/347">#347</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trio.current_instruments</span></code> is deprecated. For adding or removing
instrumentation at run-time, see <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.add_instrument" title="trio.lowlevel.add_instrument"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.hazmat.add_instrument</span></code></a>
and <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.remove_instrument" title="trio.lowlevel.remove_instrument"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.hazmat.remove_instrument</span></code></a> (<a class="reference external" href="https://github.com/python-trio/trio/issues/257">#257</a>)</p></li>
</ul>
<p>Unfortunately, a limitation in PyPy3 5.8 breaks our deprecation
handling for some renames. (Attempting to use the old names will give
an unhelpful error instead of a helpful warning.) This does not affect
CPython, or PyPy3 5.9+.</p>
</section>
<section id="other-changes">
<h3>Other changes<a class="headerlink" href="#other-changes" title="Link to this heading">¶</a></h3>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">run_sync_in_worker_thread</span></code> now has a <a class="reference internal" href="ref-core/threads.html#worker-thread-limiting"><span class="std std-ref">robust mechanism
for applying capacity limits to the number of concurrent threads</span></a> (<a class="reference external" href="https://github.com/python-trio/trio/issues/170">#10</a>, <a class="reference external" href="https://github.com/python-trio/trio/issues/57">#57</a>, <a class="reference external" href="https://github.com/python-trio/trio/issues/156">#156</a>)</p></li>
<li><p>New support for tests to cleanly hook hostname lookup and socket
operations: see <a class="reference internal" href="reference-testing.html#virtual-network-hooks"><span class="std std-ref">用于测试的虚拟网络</span></a>. In addition,
<code class="docutils literal notranslate"><span class="pre">trio.socket.SocketType</span></code> is now an empty abstract base class, with
the actual socket class made private. This shouldn't effect anyone,
since the only thing you could directly use it for in the first
place was <code class="docutils literal notranslate"><span class="pre">isinstance</span></code> checks, and those still work (<a class="reference external" href="https://github.com/python-trio/trio/issues/170">#170</a>)</p></li>
<li><p>New class <a class="reference internal" href="ref-core/task_sync.html#trio.StrictFIFOLock" title="trio.StrictFIFOLock"><code class="xref py py-class docutils literal notranslate"><span class="pre">StrictFIFOLock</span></code></a></p></li>
<li><p>New exception <code class="docutils literal notranslate"><span class="pre">ResourceBusyError</span></code></p></li>
<li><p>The <a class="reference internal" href="reference-lowlevel.html#trio.lowlevel.ParkingLot" title="trio.lowlevel.ParkingLot"><code class="xref py py-class docutils literal notranslate"><span class="pre">trio.hazmat.ParkingLot</span></code></a> class (which is used to
implement many of Trio's synchronization primitives) was rewritten
to be simpler and faster (<a class="reference external" href="https://github.com/python-trio/trio/issues/272">#272</a>, <a class="reference external" href="https://github.com/python-trio/trio/issues/287">#287</a>)</p></li>
<li><p>It's generally true that if you're using Trio you have to use Trio
functions, if you're using asyncio you have to use asyncio
functions, and so forth. (See the discussion of the "async sandwich"
in the Trio tutorial for more details.) So for example, this isn't
going to work:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># asyncio here</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># trio here</span>
<span class="n">trio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
</pre></div>
</div>
<p>Trio now reliably detects if you accidentally do something like
this, and gives a helpful error message.</p>
</li>
<li><p>Trio now also has special error messages for several other common
errors, like doing <code class="docutils literal notranslate"><span class="pre">trio.run(some_func())</span></code> (should be
<code class="docutils literal notranslate"><span class="pre">trio.run(some_func)</span></code>).</p></li>
<li><p><a class="reference internal" href="ref-io/low_level.html#module-trio.socket" title="trio.socket"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.socket</span></code></a> now handles non-ascii domain names using the
modern IDNA 2008 standard instead of the obsolete IDNA 2003 standard
(<a class="reference external" href="https://github.com/python-trio/trio/issues/11">#11</a>)</p></li>
<li><p>When an <a class="reference internal" href="reference-lowlevel.html#trio.abc.Instrument" title="trio.abc.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a> raises an unexpected error, we
now route it through the <a class="reference external" href="https://docs.python.org/zh-cn/3/library/logging.html#module-logging" title="（在 Python v3.13）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">logging</span></code></a> module instead of printing
it directly to stderr. Normally this produces exactly the same
effect, but this way it's more configurable. (<a class="reference external" href="https://github.com/python-trio/trio/issues/306">#306</a>)</p></li>
<li><p>Fixed a minor race condition in IOCP thread shutdown on Windows
(<a class="reference external" href="https://github.com/python-trio/trio/issues/81">#81</a>)</p></li>
<li><p>Control-C handling on Windows now uses <a class="reference external" href="https://docs.python.org/zh-cn/3/library/signal.html#signal.set_wakeup_fd" title="（在 Python v3.13）"><code class="xref py py-func docutils literal notranslate"><span class="pre">signal.set_wakeup_fd()</span></code></a>
and should be more reliable (<a class="reference external" href="https://github.com/python-trio/trio/issues/42">#42</a>)</p></li>
<li><p><a class="reference internal" href="ref-core/run.html#trio.run" title="trio.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.run()</span></code></a> takes a new keyword argument
<code class="docutils literal notranslate"><span class="pre">restrict_keyboard_interrupt_to_checkpoints</span></code></p></li>
<li><p>New attributes allow more detailed introspection of the task tree:
<code class="docutils literal notranslate"><span class="pre">nursery.child_tasks</span></code>, <code class="docutils literal notranslate"><span class="pre">Task.child_nurseries</span></code>,
<code class="docutils literal notranslate"><span class="pre">nursery.parent_task</span></code>, <code class="docutils literal notranslate"><span class="pre">Task.parent_nursery</span></code></p></li>
<li><p><a class="reference internal" href="reference-testing.html#trio.testing.wait_all_tasks_blocked" title="trio.testing.wait_all_tasks_blocked"><code class="xref py py-func docutils literal notranslate"><span class="pre">trio.testing.wait_all_tasks_blocked()</span></code></a> now takes a
<code class="docutils literal notranslate"><span class="pre">tiebreaker=</span></code> argument. The main use is to allow
<a class="reference internal" href="reference-testing.html#trio.testing.MockClock" title="trio.testing.MockClock"><code class="xref py py-class docutils literal notranslate"><span class="pre">MockClock</span></code></a>'s auto-jump functionality to avoid
interfering with direct use of
<a class="reference internal" href="reference-testing.html#trio.testing.wait_all_tasks_blocked" title="trio.testing.wait_all_tasks_blocked"><code class="xref py py-func docutils literal notranslate"><span class="pre">wait_all_tasks_blocked()</span></code></a> in the same test.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MultiError.catch()</span></code> now correctly preserves <code class="docutils literal notranslate"><span class="pre">__context__</span></code>,
despite Python's best attempts to stop us (<a class="reference external" href="https://github.com/python-trio/trio/issues/165">#165</a>)</p></li>
<li><p>It is now possible to take weakrefs to <a class="reference internal" href="ref-core/task_sync.html#trio.Lock" title="trio.Lock"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lock</span></code></a> and many other
classes (<a class="reference external" href="https://github.com/python-trio/trio/issues/331">#331</a>)</p></li>
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">sock.accept()</span></code> for IPv6 sockets (<a class="reference external" href="https://github.com/python-trio/trio/issues/164">#164</a>)</p></li>
<li><p>PyCharm (and hopefully other IDEs) can now offer better completions
for the <a class="reference internal" href="ref-core/time_clock.html#module-trio" title="trio"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio</span></code></a> and <a class="reference internal" href="reference-lowlevel.html#module-trio.lowlevel" title="trio.lowlevel"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trio.hazmat</span></code></a> modules (<a class="reference external" href="https://github.com/python-trio/trio/issues/314">#314</a>)</p></li>
<li><p>Trio now uses <a class="reference external" href="https://github.com/google/yapf">yapf</a> to
standardize formatting across the source tree, so we never have to
think about whitespace again.</p></li>
<li><p>Many documentation improvements</p></li>
</ul>
</section>
</section>
<section id="trio-0-1-0-2017-03-10">
<h2>Trio 0.1.0 (2017-03-10)<a class="headerlink" href="#trio-0-1-0-2017-03-10" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Initial release.</p></li>
</ul>
</section>
</section>
</article>
</div>
<footer>
<div class="related-pages">
<a class="next-page" href="contributing.html">
<div class="page-info">
<div class="context">
<span>Next</span>
</div>
<div class="title">为 Trio 及相关项目做出贡献</div>
</div>
<svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
</a>
<a class="prev-page" href="design.html">
<svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
<div class="page-info">
<div class="context">
<span>Previous</span>
</div>
<div class="title">设计和内部结构</div>
</div>
</a>
</div>
<div class="bottom-of-page">
<div class="left-details">
<div class="copyright">
                Copyright © 2017, Nathaniel J. Smith
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
</div>
<div class="right-details">
<div class="icons">
<a aria-label="GitHub" class="muted-link" href="https://github.com/hellowac/trio-zh-cn">
<svg fill="currentColor" stroke="currentColor" stroke-width="0" viewbox="0 0 16 16">
<path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z" fill-rule="evenodd"></path>
</svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<aside class="toc-drawer">
<div class="toc-sticky toc-scroll">
<div class="toc-title-container">
<span class="toc-title">
            On this page
          </span>
</div>
<div class="toc-tree-container">
<div class="toc-tree">
<ul>
<li><a class="reference internal" href="#">发布历史</a><ul>
<li><a class="reference internal" href="#trio-0-27-0-2024-10-17">Trio 0.27.0 (2024-10-17)</a><ul>
<li><a class="reference internal" href="#id2">重大变更</a></li>
<li><a class="reference internal" href="#id3">功能</a></li>
<li><a class="reference internal" href="#bug">bug修复</a></li>
<li><a class="reference internal" href="#id4">改进文档</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-26-2-2024-08-08">Trio 0.26.2 (2024-08-08)</a><ul>
<li><a class="reference internal" href="#bugfixes">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-26-1-2024-08-05">Trio 0.26.1 (2024-08-05)</a><ul>
<li><a class="reference internal" href="#id5">Bugfixes</a></li>
<li><a class="reference internal" href="#miscellaneous-internal-changes">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-26-0-2024-07-05">Trio 0.26.0 (2024-07-05)</a><ul>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#id6">Bugfixes</a></li>
<li><a class="reference internal" href="#deprecations-and-removals">Deprecations and removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-25-1-2024-05-16">Trio 0.25.1 (2024-05-16)</a><ul>
<li><a class="reference internal" href="#id7">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-25-0-2024-03-17">Trio 0.25.0 (2024-03-17)</a><ul>
<li><a class="reference internal" href="#breaking-changes">Breaking changes</a></li>
<li><a class="reference internal" href="#id8">Features</a></li>
<li><a class="reference internal" href="#id9">Bugfixes</a></li>
<li><a class="reference internal" href="#id10">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-24-0-2024-01-10">Trio 0.24.0 (2024-01-10)</a><ul>
<li><a class="reference internal" href="#id11">Features</a></li>
<li><a class="reference internal" href="#id12">Deprecations and removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-23-2-2023-12-14">Trio 0.23.2 (2023-12-14)</a><ul>
<li><a class="reference internal" href="#id13">Features</a></li>
<li><a class="reference internal" href="#id14">Bugfixes</a></li>
<li><a class="reference internal" href="#id15">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-23-1-2023-11-04">Trio 0.23.1 (2023-11-04)</a><ul>
<li><a class="reference internal" href="#id16">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-23-0-2023-11-03">Trio 0.23.0 (2023-11-03)</a><ul>
<li><a class="reference internal" href="#headline-features">Headline features</a></li>
<li><a class="reference internal" href="#id17">Features</a></li>
<li><a class="reference internal" href="#id18">Bugfixes</a></li>
<li><a class="reference internal" href="#id19">Deprecations and removals</a></li>
<li><a class="reference internal" href="#removals-without-deprecations">Removals without deprecations</a></li>
<li><a class="reference internal" href="#id20">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-22-2-2023-07-13">Trio 0.22.2 (2023-07-13)</a><ul>
<li><a class="reference internal" href="#id21">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-22-1-2023-07-02">Trio 0.22.1 (2023-07-02)</a><ul>
<li><a class="reference internal" href="#id22">Breaking changes</a></li>
<li><a class="reference internal" href="#id23">Features</a></li>
<li><a class="reference internal" href="#id24">Bugfixes</a></li>
<li><a class="reference internal" href="#improved-documentation">Improved documentation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-22-0-2022-09-28">Trio 0.22.0 (2022-09-28)</a><ul>
<li><a class="reference internal" href="#id25">Headline features</a></li>
<li><a class="reference internal" href="#id26">Features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-21-0-2022-06-07">Trio 0.21.0 (2022-06-07)</a><ul>
<li><a class="reference internal" href="#id27">Features</a></li>
<li><a class="reference internal" href="#id28">Deprecations and Removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-20-0-2022-02-21">Trio 0.20.0 (2022-02-21)</a><ul>
<li><a class="reference internal" href="#id29">Features</a></li>
<li><a class="reference internal" href="#id30">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-19-0-2021-06-15">Trio 0.19.0 (2021-06-15)</a><ul>
<li><a class="reference internal" href="#id31">Features</a></li>
<li><a class="reference internal" href="#id32">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-18-0-2021-01-11">Trio 0.18.0 (2021-01-11)</a><ul>
<li><a class="reference internal" href="#id33">Features</a></li>
<li><a class="reference internal" href="#id34">Bugfixes</a></li>
<li><a class="reference internal" href="#id35">Deprecations and removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-17-0-2020-09-15">Trio 0.17.0 (2020-09-15)</a><ul>
<li><a class="reference internal" href="#id36">Headline features</a></li>
<li><a class="reference internal" href="#id37">Features</a></li>
<li><a class="reference internal" href="#id38">Bugfixes</a></li>
<li><a class="reference internal" href="#id39">Deprecations and removals</a></li>
<li><a class="reference internal" href="#id40">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-16-0-2020-06-10">Trio 0.16.0 (2020-06-10)</a><ul>
<li><a class="reference internal" href="#id41">Headline features</a></li>
<li><a class="reference internal" href="#id42">Features</a></li>
<li><a class="reference internal" href="#id43">Bugfixes</a></li>
<li><a class="reference internal" href="#id44">Deprecations and removals</a></li>
<li><a class="reference internal" href="#id45">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-15-1-2020-05-22">Trio 0.15.1 (2020-05-22)</a><ul>
<li><a class="reference internal" href="#id46">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-15-0-2020-05-19">Trio 0.15.0 (2020-05-19)</a><ul>
<li><a class="reference internal" href="#id47">Features</a></li>
<li><a class="reference internal" href="#id48">Bugfixes</a></li>
<li><a class="reference internal" href="#id49">Deprecations and Removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-14-0-2020-04-27">Trio 0.14.0 (2020-04-27)</a><ul>
<li><a class="reference internal" href="#id50">Features</a></li>
<li><a class="reference internal" href="#id51">Bugfixes</a></li>
<li><a class="reference internal" href="#id52">Deprecations and Removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-13-0-2019-11-02">Trio 0.13.0 (2019-11-02)</a><ul>
<li><a class="reference internal" href="#id53">Features</a></li>
<li><a class="reference internal" href="#id54">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-12-1-2019-08-01">Trio 0.12.1 (2019-08-01)</a><ul>
<li><a class="reference internal" href="#id55">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-12-0-2019-07-31">Trio 0.12.0 (2019-07-31)</a><ul>
<li><a class="reference internal" href="#id56">Features</a></li>
<li><a class="reference internal" href="#id57">Bugfixes</a></li>
<li><a class="reference internal" href="#id58">Improved Documentation</a></li>
<li><a class="reference internal" href="#id59">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id60">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-11-0-2019-02-09">Trio 0.11.0 (2019-02-09)</a><ul>
<li><a class="reference internal" href="#id61">Features</a></li>
<li><a class="reference internal" href="#id62">Bugfixes</a></li>
<li><a class="reference internal" href="#id63">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id64">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-10-0-2019-01-07">Trio 0.10.0 (2019-01-07)</a><ul>
<li><a class="reference internal" href="#id65">Features</a></li>
<li><a class="reference internal" href="#id66">Bugfixes</a></li>
<li><a class="reference internal" href="#id67">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id68">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-9-0-2018-10-12">Trio 0.9.0 (2018-10-12)</a><ul>
<li><a class="reference internal" href="#id69">Features</a></li>
<li><a class="reference internal" href="#id70">Deprecations and Removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-8-0-2018-10-01">Trio 0.8.0 (2018-10-01)</a><ul>
<li><a class="reference internal" href="#id71">Features</a></li>
<li><a class="reference internal" href="#id72">Deprecations and Removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-7-0-2018-09-03">Trio 0.7.0 (2018-09-03)</a><ul>
<li><a class="reference internal" href="#id73">Features</a></li>
<li><a class="reference internal" href="#id74">Bugfixes</a></li>
<li><a class="reference internal" href="#id75">Deprecations and Removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-6-0-2018-08-13">Trio 0.6.0 (2018-08-13)</a><ul>
<li><a class="reference internal" href="#id76">Features</a></li>
<li><a class="reference internal" href="#id77">Bugfixes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-5-0-2018-07-20">Trio 0.5.0 (2018-07-20)</a><ul>
<li><a class="reference internal" href="#id78">Features</a></li>
<li><a class="reference internal" href="#id79">Deprecations and Removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-4-0-2018-04-10">Trio 0.4.0 (2018-04-10)</a><ul>
<li><a class="reference internal" href="#id80">Features</a></li>
<li><a class="reference internal" href="#id81">Bugfixes</a></li>
<li><a class="reference internal" href="#id82">Deprecations and Removals</a></li>
<li><a class="reference internal" href="#id83">Miscellaneous internal changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-3-0-2017-12-28">Trio 0.3.0 (2017-12-28)</a><ul>
<li><a class="reference internal" href="#id84">Features</a></li>
<li><a class="reference internal" href="#id85">Bugfixes</a></li>
<li><a class="reference internal" href="#id86">Deprecations and Removals</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-2-0-2017-12-06">Trio 0.2.0 (2017-12-06)</a><ul>
<li><a class="reference internal" href="#highlights">Highlights</a></li>
<li><a class="reference internal" href="#breaking-changes-and-deprecations">Breaking changes and deprecations</a></li>
<li><a class="reference internal" href="#other-changes">Other changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trio-0-1-0-2017-03-10">Trio 0.1.0 (2017-03-10)</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</aside>
</div>
</div><script src="_static/documentation_options.js?v=d2451d57"></script>
<script src="_static/doctools.js?v=9bcbadda"></script>
<script src="_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="_static/scripts/furo.js?v=5fa4622c"></script>
<script src="_static/tabs.js?v=3ee01567"></script>
<script src="_static/clipboard.min.js?v=a7894cd8"></script>
<script src="_static/copybutton.js?v=f281be69"></script>
<script src="_static/translations.js?v=beaddf03"></script>
</body>
</html>